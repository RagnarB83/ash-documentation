<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>QM Interfaces &mdash; Ash 0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/my_theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="MM Interfaces" href="MM-interfaces.html" />
    <link rel="prev" title="Parallelization in ASH" href="parallelization.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
            <a href="index.html" class="icon icon-home"> Ash
            <img src="_static/ash-simple-logo-letterbig.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">ASH</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="About.html">About ASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Basic usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic-examples.html">Basic examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="ash_program_philosophy.html">ASH Program Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="coordinate-input.html">Coordinates and fragments</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallelization.html">Parallelization in ASH</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">QM Interfaces</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#attributes-and-methods-available-to-all-qm-interfaces">Attributes and methods available to all QM interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="#orcatheory">ORCATheory</a></li>
<li class="toctree-l2"><a class="reference internal" href="#xtbtheory">xTBTheory</a></li>
<li class="toctree-l2"><a class="reference internal" href="#psi4theory">Psi4Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyscftheory">PySCFTheory</a></li>
<li class="toctree-l2"><a class="reference internal" href="#daltontheory">DaltonTheory</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cfourtheory">CFourTheory</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mrcctheory">MRCCTheory</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MM-interfaces.html">MM Interfaces</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Jobtypes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="job-types.html">Job Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="singlepoint.html">Singlepoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_freq.html">Frequency calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_dynamics.html">Molecular dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="neb.html">Nudged Elastic Band Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="surfacescan.html">Surface Scans</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="module_QM-MM.html">QM/MM Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_benchmarking.html">Benchmarking in ASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_workflows.html">Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_highlevel_workflows.html">Highlevel workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_molcrys.html">MOLCRYS: Automatic QM/MM for Molecular Crystals</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_PES.html">PES: PhotoElectron/PhotoEmission Spectrum</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_plotting.html">Plotting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Interfaces</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ORCA-interface.html">ORCA interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="xTB-interface.html">xTB interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="MRCC-interface.html">MRCC interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="CFour-interface.html">CFour interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dalton-interface.html">Dalton interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="PySCF-interface.html">PySCF interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Psi4-interface.html">Psi4 interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="crest-interface.html">CREST interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="geomeTRIC-interface.html">geomeTRIC interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="knarr-interface.html">KNARR interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="OpenMM-interface.html">OpenMM interface</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Explicit-solvation.html">Explicit solvation (small molecule)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metalloprotein-I.html">Metalloprotein tutorial I: Rubredoxin</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metalloprotein-II.html">Metalloprotein tutorial II: Ferredoxin</a></li>
<li class="toctree-l1"><a class="reference internal" href="QM-MM-protein.html">QM/MM on a protein</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflows-examples.html">Workflow examples in ASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="thermochemistry.html">High-level Thermochemistry in ASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="Highlevel_CC_CBS_workflows.html">Tutorial: High-level CCSD(T)/CBS workflows</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="coordinate-tools.html">Coordinates and fragment tools</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Ash</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>QM Interfaces</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/QM-interfaces.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="qm-interfaces">
<h1>QM Interfaces<a class="headerlink" href="#qm-interfaces" title="Permalink to this headline"></a></h1>
<p>Quantum chemistry codes that you can currently use with ASH are: ORCA, xTB, PySCF, Psi4, Dalton, CFour, MRCC.
To use the interfaces you define a QMtheory object of the appropriate Class.
The QM-interface Classes available are: ORCATheory, xTBTheory, PySCFTheory, Psi4Theory, DaltonTheory, CFourTheory, MRCCTheory.</p>
<p>When defining a QMtheory object you are creating an instance of one of the QMTheory classes.
When defining the object, a few keyword arguments are required, that differs between classes.
Parallelization of the QM codes differs behind the scenes but is controlled by a numcores=X keyword for all interfaces.</p>
<p>Example:</p>
<p>Below, we create a dummy QMcalc object of the dummy class QMTheory.
The arguments that QMTheory takes will depend on the interface but typically we would at least set the numcores keyword (available for all QM theories) that defines how many CPU cores the QM program is allowed to use.
numcores=1 is the default and the keyword can be skipped if one wants a serial calculation.
One would then add other keywords that are specific to the QMtheory used that will define the QM method and basis etc.).
Note that it is a design choice in ASH to not define general variables such as functional, basis set (that could in theory be used for all interfaces) as this would heavily restrict the flexibility of the interface.
Instead, each interface differs in how the electronic structure details are defined, with the aim of allowing you to select any method you prefer to use in the respective QM code.</p>
<p>Once both a fragment object and a theory object has been created we can run a basic single-point energy calculation.
This is done using the Singlepoint function that requires both theory and fragment keyword arguments. Additionally charge and multiplicity information needs to be provided.</p>
<p>Charge and multiplicity information is either provided to the fragment object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Create fragment object from XYZ-file</span>
<span class="n">HF_frag</span><span class="o">=</span><span class="n">Fragment</span><span class="p">(</span><span class="n">xyzfile</span><span class="o">=</span><span class="s1">&#39;hf.xyz&#39;</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mult</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Defining an object of the (dummy) class QMTheory</span>
<span class="n">QMcalc</span> <span class="o">=</span> <span class="n">QMTheory</span><span class="p">(</span><span class="n">numcores</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="c1">#Run a single-point energy job</span>
<span class="n">Singlepoint</span><span class="p">(</span><span class="n">theory</span><span class="o">=</span><span class="n">QMcalc</span><span class="p">,</span> <span class="n">fragment</span><span class="o">=</span><span class="n">HF_frag</span><span class="p">)</span>
</pre></div>
</div>
<p>or it can be provided to the jobtype function (here Singlepoint):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Create fragment object from XYZ-file</span>
<span class="n">HF_frag</span><span class="o">=</span><span class="n">Fragment</span><span class="p">(</span><span class="n">xyzfile</span><span class="o">=</span><span class="s1">&#39;hf.xyz&#39;</span><span class="p">)</span>
<span class="c1"># Defining an object of the (dummy) class QMTheory</span>
<span class="n">QMcalc</span> <span class="o">=</span> <span class="n">QMTheory</span><span class="p">(</span><span class="n">numcores</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="c1">#Run a single-point energy job</span>
<span class="n">Singlepoint</span><span class="p">(</span><span class="n">theory</span><span class="o">=</span><span class="n">QMcalc</span><span class="p">,</span> <span class="n">fragment</span><span class="o">=</span><span class="n">HF_frag</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mult</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>When running an ASH script involving multiple fragments (that differ w.r.t. charge/mult), it is best to associate charge/mult attributes to the fragment.
The charge/mult information from the fragment will then be provided to the theory object when run via the respective job-function (Singlepoint, geomeTRICOptimizer etc.) instead.</p>
<div class="section" id="attributes-and-methods-available-to-all-qm-interfaces">
<h2>Attributes and methods available to all QM interfaces<a class="headerlink" href="#attributes-and-methods-available-to-all-qm-interfaces" title="Permalink to this headline"></a></h2>
<p><strong>Attributes</strong></p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Keyword</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default value</p></th>
<th class="head"><p>Details</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">printlevel</span></code></p></td>
<td><p>integer</p></td>
<td><p>2</p></td>
<td><p>The level of printing to use when QMTheory is defined or run.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">numcores</span></code></p></td>
<td><p>integer</p></td>
<td><p>1</p></td>
<td><p>The number of CPU cores that the QM program will use (parallelization may be MPI or thread-based).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">label</span></code></p></td>
<td><p>string</p></td>
<td><p>None</p></td>
<td><p>A string-label that can be useful to distinguish different QMTheory objects.</p></td>
</tr>
</tbody>
</table>
<p><strong>Methods</strong></p>
<ul class="simple">
<li><p>run(self, current_coords=None, charge=None, mult=None, current_MM_coords=None, MMcharges=None, qm_elems=None, elems=None, Grad=False, Hessian=False, PC=False, numcores=None, label=None).</p></li>
<li><p>cleanup(self)</p></li>
</ul>
<p>Each QMTheory class has a run method that will be called by a jobtype function (e.g. Singlepoint or geomeTRICOptimizer) and the current coordinates will be provided.</p>
<p>The cleanup method removes temporary files created by the QM-program (or ASH) that may interfer with the next calculation.</p>
</div>
<div class="section" id="orcatheory">
<h2>ORCATheory<a class="headerlink" href="#orcatheory" title="Permalink to this headline"></a></h2>
<p>See <a class="reference internal" href="ORCA-interface.html"><span class="doc">ORCA interface</span></a></p>
</div>
<div class="section" id="xtbtheory">
<h2>xTBTheory<a class="headerlink" href="#xtbtheory" title="Permalink to this headline"></a></h2>
<p>See <a class="reference internal" href="xTB-interface.html"><span class="doc">xTB interface</span></a></p>
</div>
<div class="section" id="psi4theory">
<h2>Psi4Theory<a class="headerlink" href="#psi4theory" title="Permalink to this headline"></a></h2>
<p>See <a class="reference internal" href="Psi4-interface.html"><span class="doc">Psi4 interface</span></a></p>
</div>
<div class="section" id="pyscftheory">
<h2>PySCFTheory<a class="headerlink" href="#pyscftheory" title="Permalink to this headline"></a></h2>
<p>See <a class="reference internal" href="PySCF-interface.html"><span class="doc">PySCF interface</span></a></p>
</div>
<div class="section" id="daltontheory">
<h2>DaltonTheory<a class="headerlink" href="#daltontheory" title="Permalink to this headline"></a></h2>
<p>See <a class="reference internal" href="Dalton-interface.html"><span class="doc">Dalton interface</span></a></p>
</div>
<div class="section" id="cfourtheory">
<h2>CFourTheory<a class="headerlink" href="#cfourtheory" title="Permalink to this headline"></a></h2>
<p>See <a class="reference internal" href="CFour-interface.html"><span class="doc">CFour interface</span></a></p>
</div>
<div class="section" id="mrcctheory">
<h2>MRCCTheory<a class="headerlink" href="#mrcctheory" title="Permalink to this headline"></a></h2>
<p>See <a class="reference internal" href="MRCC-interface.html"><span class="doc">MRCC interface</span></a></p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="parallelization.html" class="btn btn-neutral float-left" title="Parallelization in ASH" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="MM-interfaces.html" class="btn btn-neutral float-right" title="MM Interfaces" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Ragnar Bjornsson.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXX-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-XXXXXXX-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>