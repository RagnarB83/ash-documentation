<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MM Interfaces &mdash; Ash 0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/my_theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Job Types" href="job-types.html" />
    <link rel="prev" title="QM Interfaces" href="QM-interfaces.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
            <a href="index.html" class="icon icon-home"> Ash
            <img src="_static/ash-simple-logo-letterbig.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">ASH</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="About.html">About ASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Basic usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic-examples.html">Basic examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="ash_program_philosophy.html">ASH Program Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="coordinate-input.html">Coordinates and fragments</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallelization.html">Parallelization in ASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="QM-interfaces.html">QM Interfaces</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">MM Interfaces</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#nonbondedtheory">NonBondedTheory</a></li>
<li class="toctree-l2"><a class="reference internal" href="#openmm-interface">OpenMM interface</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Jobtypes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="job-types.html">Job Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="singlepoint.html">Singlepoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_freq.html">Frequency calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_dynamics.html">Molecular dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="neb.html">Nudged Elastic Band Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="surfacescan.html">Surface Scans</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="module_QM-MM.html">QM/MM Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_benchmarking.html">Benchmarking in ASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_workflows.html">Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_highlevel_workflows.html">Highlevel workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_molcrys.html">MOLCRYS: Automatic QM/MM for Molecular Crystals</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_PES.html">PES: PhotoElectron/PhotoEmission Spectrum</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_plotting.html">Plotting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Interfaces</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ORCA-interface.html">ORCA interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="xTB-interface.html">xTB interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="MRCC-interface.html">MRCC interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="CFour-interface.html">CFour interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dalton-interface.html">Dalton interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="PySCF-interface.html">PySCF interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Psi4-interface.html">Psi4 interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="crest-interface.html">CREST interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="geomeTRIC-interface.html">geomeTRIC interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="knarr-interface.html">KNARR interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="OpenMM-interface.html">OpenMM interface</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Explicit-solvation.html">Explicit solvation (small molecule)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metalloprotein-I.html">Metalloprotein tutorial I: Rubredoxin</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metalloprotein-II.html">Metalloprotein tutorial II: Ferredoxin</a></li>
<li class="toctree-l1"><a class="reference internal" href="QM-MM-protein.html">QM/MM on a protein</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflows-examples.html">Workflow examples in ASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="Highlevel_CC_CBS_workflows.html">Tutorial: High-level CCSD(T)/CBS workflows</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="coordinate-tools.html">Coordinates and fragment tools</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Ash</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>MM Interfaces</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/MM-interfaces.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="mm-interfaces">
<h1>MM Interfaces<a class="headerlink" href="#mm-interfaces" title="Permalink to this headline"></a></h1>
<p>Molecular mechanics in ASH is possible via either the internal NonBondedTheory or via an interface to the external OpenMM package: <a class="reference internal" href="OpenMM-interface.html"><span class="doc">OpenMM interface</span></a></p>
<p>The internal NonBondedTheory is only capable of calculating nonbonded interactions: Coulomb electrostatics and short-range Lennard-Jones interactions.
It will use routines written in Julia and thus require activating the Python-Julia interface.
Nonbonded Theory can be used in geometry optimizations provided that the MM atoms are always frozen.
It can be used as MM code in QM/MM (<a class="reference internal" href="module_QM-MM.html"><span class="doc">QM/MM Theory</span></a>) theory objects.</p>
<p>The interface to the external OpenMM code (<a class="reference internal" href="OpenMM-interface.html"><span class="doc">OpenMM interface</span></a>) allows for full-fledged molecular mechanics.
OpenMM is a fast C++ code with a Python API that ASH is interfaced to.
OpenMM is capable of bonded and nonbonded interactions, can treat periodic and nonperiodic systems and can read in multiple types of forcefield files.
It can also run both on the CPU and the GPU.
It can be used as MM code in QM/MM (<a class="reference internal" href="module_QM-MM.html"><span class="doc">QM/MM Theory</span></a>) theory objects.</p>
<div class="section" id="nonbondedtheory">
<h2>NonBondedTheory<a class="headerlink" href="#nonbondedtheory" title="Permalink to this headline"></a></h2>
<p>The NonBondedTheory class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">NonBondedTheory</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atomtypes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">forcefield</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">charges</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">LJcombrule</span><span class="o">=</span><span class="s1">&#39;geometric&#39;</span><span class="p">,</span>
                 <span class="n">codeversion</span><span class="o">=</span><span class="s1">&#39;julia&#39;</span><span class="p">,</span> <span class="n">printlevel</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
</pre></div>
</div>
<p>Defining a NonBondedTheory object is easy and can be accomplished in a few different ways.
A simple way is to define all information in the script itself. This requires defining the MM forcefield as a dictionary
and then provides a list of atomtypes of the system as a minimum. In the forcefield we then define the Coulomb and Lennard-Jones parameters
associated with the atomtypes.</p>
<p>Simple way (forcefield_dict and atomtypes):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ash</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">HF_frag</span><span class="o">=</span><span class="n">Fragment</span><span class="p">(</span><span class="n">xyzfile</span><span class="o">=</span><span class="s2">&quot;hf.xyz&quot;</span><span class="p">)</span>
<span class="c1">#Defining atomtypes &#39;HT&#39; for hydrogen and atomtype &#39;FX&#39; for fluorine. These atomtypes can be named anything.</span>
<span class="n">atomtypes</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;HT&#39;</span><span class="p">,</span> <span class="s1">&#39;FX&#39;</span><span class="p">]</span>

<span class="n">MM_forcefield</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">MM_forcefield</span><span class="p">[</span><span class="n">atomtype</span><span class="p">]</span><span class="o">=</span><span class="n">AtomMMobject</span><span class="p">()</span>
<span class="n">MM_forcefield</span><span class="p">[</span><span class="n">atomtype</span><span class="p">]</span><span class="o">.</span><span class="n">add_charge</span><span class="p">(</span><span class="n">atomcharge</span><span class="o">=</span><span class="n">charge</span><span class="p">)</span>
<span class="n">MM_forcefield</span><span class="p">[</span><span class="n">atomtype</span><span class="p">]</span><span class="o">.</span><span class="n">add_LJparameters</span><span class="p">(</span><span class="n">LJparameters</span><span class="o">=</span><span class="p">[</span><span class="n">sigma_i</span><span class="p">,</span><span class="n">eps_i</span><span class="p">])</span>
<span class="n">HF_MM_forcefield</span><span class="o">=</span> <span class="p">{</span><span class="s1">&#39;HT&#39;</span> <span class="p">:</span> <span class="n">LJparameters</span><span class="p">}</span>

<span class="n">MMobject</span> <span class="o">=</span> <span class="n">NonBondedTheory</span><span class="p">(</span><span class="n">forcefield</span><span class="o">=</span><span class="n">MM_forcefield</span><span class="p">,</span> <span class="n">atomtypes</span><span class="o">=</span><span class="n">atomtypes</span><span class="p">,</span> <span class="n">LJcombrule</span><span class="o">=</span><span class="s1">&#39;geometric&#39;</span><span class="p">)</span>

<span class="n">Singlepoint</span><span class="p">(</span><span class="n">fragment</span><span class="o">=</span><span class="n">HF_frag</span><span class="p">,</span><span class="n">theory</span><span class="o">=</span><span class="n">MMobject</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternative is to define the forcefield in a forcefieldfile that is read-in.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ash</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">HF_frag</span><span class="o">=</span><span class="n">Fragment</span><span class="p">(</span><span class="n">xyzfile</span><span class="o">=</span><span class="s2">&quot;hf.xyz&quot;</span><span class="p">)</span>
<span class="c1">#Defining atomtypes &#39;HT&#39; for hydrogen and atomtype &#39;FX&#39; for fluorine. These atomtypes can be named anything.</span>
<span class="n">atomtypes</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;HT&#39;</span><span class="p">,</span> <span class="s1">&#39;FX&#39;</span><span class="p">]</span>
<span class="n">MM_forcefield</span><span class="o">=</span><span class="n">MMforcefield_read</span><span class="p">(</span><span class="s1">&#39;forcefield.ff&#39;</span><span class="p">)</span>

<span class="n">MMobject</span> <span class="o">=</span> <span class="n">NonBondedTheory</span><span class="p">(</span><span class="n">forcefield</span><span class="o">=</span><span class="n">MM_forcefield</span><span class="p">,</span> <span class="n">atomtypes</span><span class="o">=</span><span class="n">atomtypes</span><span class="p">,</span> <span class="n">LJcombrule</span><span class="o">=</span><span class="s1">&#39;geometric&#39;</span><span class="p">)</span>

<span class="n">Singlepoint</span><span class="p">(</span><span class="n">fragment</span><span class="o">=</span><span class="n">HF_frag</span><span class="p">,</span><span class="n">theory</span><span class="o">=</span><span class="n">MMobject</span><span class="p">)</span>
</pre></div>
</div>
<p>where forcefield.ff contains e.g.:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>LennardJones_i_sigma FX 3.150574227 -0.1521
LennardJones_i_sigma HT 3.550053212    -0.07
charge FX -0.9
charge HT 0.9
</pre></div>
</div>
<p>The forcefield file will read and parse lines like:</p>
<ul class="simple">
<li><p>LennardJones_i_sigma &lt;atomtype&gt; &lt;sigma&gt; &lt;epsilon&gt; # Specify atomtype and sigma-value (Å) and epsilon value (kcal/mol)</p></li>
<li><p>LennardJones_i_R0 &lt;atomtype&gt; &lt;R0&gt; &lt;epsilon&gt;  # Specify atomtype and R0-value (Å) and epsilon value (kcal/mol)</p></li>
<li><p>LennardJones_ij &lt;atomtype1&gt; &lt;atomtype2&gt;  &lt;R0_ij&gt; &lt;epsilon pair parameter&gt; #Specify pair-potential. Currently inactive option</p></li>
<li><p>charge &lt;atomtype&gt; &lt;chargevalue&gt; # Specify atomtype and charge-value</p></li>
</ul>
<p>or other options:</p>
<ul class="simple">
<li><p>combination_rule &lt;combrule option&gt;  #For LJ potential. Can be geometric, arithmetic, mixed_geoepsilon, mixed_geosigma</p></li>
<li><p>XX_atomtypes &lt;list of atomtypes&gt; #Atomtypes for residue XX. List is space-separated.</p></li>
<li><p>XX_charges &lt;list of charges&gt; #Charges for residue XX. List is space-separated.</p></li>
<li><p>XX_elements &lt;list of elements&gt; #Elements for residue XX. List is space-separated.</p></li>
</ul>
</div>
<div class="section" id="openmm-interface">
<h2>OpenMM interface<a class="headerlink" href="#openmm-interface" title="Permalink to this headline"></a></h2>
<p>See <a class="reference internal" href="OpenMM-interface.html"><span class="doc">OpenMM interface</span></a></p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="QM-interfaces.html" class="btn btn-neutral float-left" title="QM Interfaces" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="job-types.html" class="btn btn-neutral float-right" title="Job Types" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Ragnar Bjornsson.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXX-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-XXXXXXX-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>