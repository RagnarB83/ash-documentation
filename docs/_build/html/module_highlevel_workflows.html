

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Highlevel workflows &mdash; Ash 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/my_theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="MOLCRYS: Automatic QM/MM for Molecular Crystals" href="module_molcrys.html" />
    <link rel="prev" title="Workflows" href="module_workflows.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="index.html" class="icon icon-home"> Ash
          

          
            
            <img src="_static/ash-simple-logo-letterbig.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">ASH</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="About.html">About ASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Basic usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="coordinate-input.html">Coordinates and fragments</a></li>
<li class="toctree-l1"><a class="reference internal" href="job-types.html">Job Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="QM-interfaces.html">QM Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="MM-interfaces.html">MM Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallelization.html">Parallelization in ASH</a></li>
</ul>
<p class="caption"><span class="caption-text">Internal modules</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="module_QM-MM.html">QM/MM Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_benchmarking.html">Benchmarking in ASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_coords.html">Coords module</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_dynamics.html">Dynamics module</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_freq.html">Freq module</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_workflows.html">Workflows</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Highlevel workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_molcrys.html">MOLCRYS: Automatic QM/MM for Molecular Crystals</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_PES.html">PES: PhotoElectron/PhotoEmission Spectrum</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_plotting.html">Plotting</a></li>
</ul>
<p class="caption"><span class="caption-text">Interfaces</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ORCA-interface.html">ORCA interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="xTB-interface.html">xTB interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="MRCC-interface.html">MRCC interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="CFour-interface.html">CFour interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dalton-interface.html">Dalton interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="PySCF-interface.html">PySCF interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Psi4-interface.html">Psi4 interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="crest-interface.html">CREST interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="geomeTRIC-interface.html">geomeTRIC interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="knarr-interface.html">knarr interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="OpenMM-interface.html">OpenMM interface</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Explicit-solvation.html">Explicit solvation (small molecule)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metalloprotein-I.html">Metalloprotein tutorial I: Rubredoxin</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metalloprotein-II.html">Metalloprotein tutorial II: Ferredoxin</a></li>
<li class="toctree-l1"><a class="reference internal" href="QM-MM-protein.html">QM/MM on a protein</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflows-examples.html">Workflow examples in ASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="thermochemistry.html">High-level Thermochemistry in ASH</a></li>
</ul>
<p class="caption"><span class="caption-text">Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="coordinate-tools.html">Coordinates and fragment tools</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Ash</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Highlevel workflows</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/module_highlevel_workflows.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="highlevel-workflows">
<h1>Highlevel workflows<a class="headerlink" href="#highlevel-workflows" title="Permalink to this headline">Â¶</a></h1>
<p>These high-level workflows (singlepoint energy protocols) can either be used on their own as a theory-level or used as a SP_theory in <strong>thermochemprotocol</strong> (see <a class="reference internal" href="module_workflows.html"><span class="doc">Workflows</span></a>) or as a theory in <strong>run_benchmark</strong> (see <a class="reference internal" href="module_benchmarking.html"><span class="doc">Benchmarking in ASH</span></a>) .
All of these protocols use the ORCA quantum chemistry code and give the 0 K electronic energy (no ZPVE). Gradients are not available and these can thus not be used in geometry optimizations or dynamics jobs.</p>
<p><strong>CC_CBS_Theory</strong></p>
<p>This is an ASHTheory that carries out a multi-step single-point protocol to give a CCSD(T)/CBS estimated energy
Multiple ORCA calculations for the given geometry are carried out and the SCF and correlation energies extrapolated to the CCSD(T)/CBS limit using either regular CCSD(T) theory or DLPNO-CCSD(T) theory.
This workflow is flexible and features multiple ways of approaching the CBS limit and the PNO limit.
Various options affecting the accuracy, efficiency and robustness of the protocol can be chosen.
Many basis set families can be chosen that are available for most of the periodic table.
Atomic spin-orbit coupling can be automatically included if system is an atom.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CC_CBS_Theory</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cardinals</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">basisfamily</span><span class="o">=</span><span class="s2">&quot;def2&quot;</span><span class="p">,</span> <span class="n">relativity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mult</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">orcadir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">stabilityanalysis</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">numcores</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">CVSR</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">CVbasis</span><span class="o">=</span><span class="s2">&quot;W1-mtsmall&quot;</span><span class="p">,</span> <span class="n">F12</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">Openshellreference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">DFTreference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">DFT_RI</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">auxbasis</span><span class="o">=</span><span class="s2">&quot;autoaux-max&quot;</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">scfsetting</span><span class="o">=</span><span class="s1">&#39;TightSCF&#39;</span><span class="p">,</span> <span class="n">DLPNO</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">T1</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">pnosetting</span><span class="o">=</span><span class="s1">&#39;extrapolation&#39;</span><span class="p">,</span> <span class="n">pnoextrapolation</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="n">FullLMP2Guess</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">extrainputkeyword</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">extrablocks</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">FCI</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">guessmode</span><span class="o">=</span><span class="s1">&#39;Cmatrix&#39;</span><span class="p">,</span> <span class="n">atomicSOcorrection</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Options:

- elements (list of strings): A list of elements need to be provided when creating the object. This list must contain all the elements
found in the molecular system (duplicates are fine). This list of elements is used to select an appropriate basis-set member for the
chosen basis-set-family for each element.
- cardinals (list of ints): Cardinals can be set to [2,3], [3,4], [4,5] or [5,6] (though 5Z and 6Z basis-sets are not always available
for all elements or basis set families).
- basisfamily (string): Can be set to various options. See table below.
- relativity (string): Options: &#39;DKH&#39;, &#39;ZORA&#39;, &#39;NoRel&#39;, None. Default: None
- charge/mult (integer): Charge/multiplicity of system. Should be specified unless theory is used as part of run_benchmark or thermochemprotocol.
- orcadir(string): Path-to-ORCA. Default: None
- stabilityanalysis (Boolean): Perform SCF stability analysis. Default: families
- numcores (integer): Number of cores to use in ORCA calculation.
- Openshellreference (string): Use alternative reference WF in open-shell calculation. Options: &#39;UHF&#39;, &#39;QRO&#39; Default: None
- DFTreference (string): Use DFT reference WF (orbitals) in all CC calculations. Options: (any valid DFT keyword). Default: None
- DFT_RI (Boolean): If using DFT-reference, if DFT_RI is True then RIJ/RIJCOSX with SARC/J and defgrid3 is used to
calculate DFT orbitals. Default: False
- auxbasis (string): Auxiliary basis set for CC integrals (/C type). Options: &#39;autoaux, &#39;autoaux-max&#39; Default:  &quot;autoaux-max&quot;
- memory (integer): Memory in MBs to use by ORCA. Default: 5000
- scfsetting (string): SCF-convergence setting. Options: &#39;NormalSCF&#39;, &#39;TightSCF&#39;, &#39;VeryTightSCF&#39;, &#39;ExtremeSCF&#39;. Default: &#39;TightSCF&#39;
- DLPNO (Boolean): Use of DLPNO approximation or not. Default False.
- T1 (Boolean): option to use iterative triples, i.e. DLPNO-CCSD(T1) instead of the default DLPNO-CCSD(T0)
(more accurate, more expensive). Default: True
- pnosetting (string): Accuracy-threshold of the DLPNO approximation. Options: &#39;LoosePNO&#39;, &#39;NormalPNO&#39;, &#39;TightPNO&#39;, &#39;extrapolation&#39;.
Default: &#39;extrapolation&#39;
- pnoextrapolation (list of 2 ints, X and Y): If using PNO-extrapolation then 2 DLPNO-calculations will be performed with TCutPNO=1e-X and
TCutPNO=1e-Y and extrapolated to PNO limit. Default: [6,7]
- FullLMP2Guess (Boolean): Whether to use Full-local MP2 guess in DLPNO calculations. Only use if all systems are closed-shell. Default: False
- alpha(float): Manual extrapolation parameter for SCF-extrapolation. Default: None
- beta(float): Manual extrapolation parameter for correlation-energy extrapolation. Default: None
- extrainputkeyword (string): Optional extra simple-input-keyword to add in ORCA inputfile. Default: None
- extrablocks (string): Optional extra ORCA block-input lines to add to ORCA inputfile. Default: None
- guessmode(string): What ORCA Guessmode to use when doing basis-set projections of orbitals.
Options: &#39;CMatrix&#39; (more robust), &#39;FMatrix&#39; (cheaper). Default: &#39;CMatrix&#39;
- atomicSOcorrection (Boolean). Whether to add the experimental atomic spin-orbit energy to system if the
system is an atom. Default: False
- FCI (Boolean): Whether to extrapolate the CCSD(T) calculation to the Full-CI limit by the Goodson formula. (NOT ACTIVE)
- CVSR (Boolean). Perform additional core-valence+scalar-relativistic correction. Default: False  (NOT ACTIVE)
- CVbasis (string): The core-valence basis set to use. Default: &quot;W1-mtsmall&quot; (NOT ACTIVE)
- F12 (Boolean): Use CCSD(T)-F12 approach. Default: False (NOT ACTIVE)
</pre></div>
</div>
<p><strong>Basisfamily options:</strong></p>
<p>Appropriate all-electron or valence+ECP basis sets for each element for basis-families such as : cc, aug-cc, def2, ma-def2. If instead an all-electron relativistic approch is desired for all elements then basisfamily=âcc-dkâ and relativity=âDKHâ can be chosen instead.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>âdef2â (Ahlrichs all-electron basis sets for H-Kr, valence basis+def2-ECP for K-Rn)</p></li>
<li><p>âma-def2â (minimally augmented diffuse Ahlrichs basis sets)</p></li>
<li><p>âdef2-zoraâ (ZORA-recontracted Ahlrichs basis sets or SARC-ZORA basis sets for heavy elements)</p></li>
<li><p>âma-def2-zoraâ (minimally augmented ZORA-recontracted Ahlrichs basis sets or SARC-ZORA basis sets for heavy elements)</p></li>
<li><p>âdef2-dkhâ (DKH-recontracted Ahlrichs basis sets or SARC-DKH basis sets for heavy elements)</p></li>
<li><p>âma-def2-dkhâ (minimally augmented DKH-recontracted Ahlrichs basis sets or SARC-DKH basis sets for heavy elements)</p></li>
<li><p>âccâ (correlation consistent basis sets, cc-pVnZ for light elements and cc-pVnZ-PP (SK-MCDHF ECP) for heavy elements (Sr-Xe, Hf-Rn, Ba, Ru, U)). Note: not available for K.</p></li>
<li><p>âaug-ccâ (augmented correlation consistent basis sets, cc-pVnZ for light elements and aug-cc-pVnZ-PP for heavy elements)</p></li>
<li><p>âcc-dkâ (DKH-recontracted correlation consistent basis sets, cc-pVnZ-DK for light elements and cc-pVnZ-DK for heavy elements)</p></li>
<li><p>âaug-cc-dkâ (DKH-recontracted aug correlation consistent basis sets, aug-cc-pVnZ-DK for light elements and aug-cc-pVnZ-DK for heavy elements)</p></li>
<li><p>âcc-CVâ (Core-valence correlation consistent basis sets, cc-pwCVnZ)</p></li>
<li><p>âaug-cc-CVâ (augmented core-valence correlation consistent basis sets, aug-cc-pwCVnZ)</p></li>
<li><p>âcc-CV-dkâ (DKH-recontracted core-valence correlation consistent basis sets, cc-pwCVnZ-DK)</p></li>
<li><p>âaug-cc-CV-dkâ (augmented DKH-recontracted core-valence correlation consistent basis sets, aug-cc-pwCVnZ-DK)</p></li>
</ul>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 30%" />
<col style="width: 28%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Basis-family</p></th>
<th class="head"><p>Basis-sets</p></th>
<th class="head"><p>Cardinals (n)</p></th>
<th class="head"><p>ECP on elems</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>def2</p></td>
<td><p>Ahlrichs def2
on all atoms</p></td>
<td><ul class="simple">
<li><p>2: def2-SVP</p></li>
<li><p>3: def2-TZVPP</p></li>
<li><p>4: def2-QZVPP</p></li>
</ul>
</td>
<td><p>def2-ECP
on Rb-Rn</p></td>
</tr>
<tr class="row-odd"><td><p>cc</p></td>
<td><ul class="simple">
<li><p>H-Kr: cc-pVnZ,</p></li>
<li><p>Sr-Xe: cc-pVnZ-PP,</p></li>
<li><p>Hf-Rn: cc-pVnZ-PP,</p></li>
<li><p>Ba,Ra,U: cc-pVnZ-PP</p></li>
</ul>
</td>
<td><ul class="simple">
<li><p>2: cc-pVDZ</p></li>
<li><p>3: cc-pVTZ</p></li>
<li><p>4: cc-pVQZ</p></li>
<li><p>5: cc-pV5Z</p></li>
<li><p>6: cc-pV6Z (H-Ar)</p></li>
</ul>
</td>
<td><p>SK-MCDHF-RSC
on Sr-Xe, Hf-Rn,
Ba,Ra,U</p></td>
</tr>
<tr class="row-even"><td><p>cc</p></td>
<td><ul class="simple">
<li><p>H-Kr: cc-pVnZ,</p></li>
<li><p>Sr-Xe: cc-pVnZ-PP,</p></li>
<li><p>Hf-Rn: cc-pVnZ-PP,</p></li>
<li><p>Ba,Ra,U: cc-pVnZ-PP</p></li>
</ul>
</td>
<td><ul class="simple">
<li><p>2: cc-pVDZ</p></li>
<li><p>3: cc-pVTZ</p></li>
<li><p>4: cc-pVQZ</p></li>
<li><p>5: cc-pV5Z</p></li>
<li><p>6: cc-pV6Z (H-Ar)</p></li>
</ul>
</td>
<td><p>SK-MCDHF-RSC
on Sr-Xe, Hf-Rn,
Ba,Ra,U</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>Note: missing basis for K.</p></li>
<li></li>
</ul>
<p><strong>Basic example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">N2</span><span class="o">=</span><span class="n">Fragment</span><span class="p">(</span><span class="n">xyzfile</span><span class="o">=</span><span class="s1">&#39;n2.xyz&#39;</span><span class="p">)</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">CC_CBS_Theory</span><span class="p">(</span><span class="n">elements</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;N&quot;</span><span class="p">],</span> <span class="n">cardinals</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">basisfamily</span><span class="o">=</span><span class="s2">&quot;cc&quot;</span><span class="p">,</span> <span class="n">pnosetting</span><span class="o">=</span><span class="s1">&#39;extrapolation&#39;</span><span class="p">,</span> <span class="n">pnoextrapolation</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="n">DLPNO</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">numcores</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Singlepoint</span><span class="p">(</span><span class="n">theory</span><span class="o">=</span><span class="n">cc</span><span class="p">,</span> <span class="n">fragment</span><span class="o">=</span><span class="n">N2</span><span class="p">)</span>
</pre></div>
</div>
<p>The example above defines an N2 fragment (from n2.xyz) and runs multiple CCSD(T) calculations, utilizing basis-set extrapolation of SCF and correlation energies.
Cardinals=[2,3] and basisfamily=âccâ means that the cc-pVDZ and cc-pVTZ basis sets will be used and extrapolated to the basis set limit.
Appropriate extrapolation parameters for 2-point extrapolations with this basis set family are chosen.</p>
<p><strong>Example: DLPNO-CCSD(T1)/CBS with PNO extrapolation on a 4d-metal complex with the Ahlrichs def2-SVP/def2-TZVPP extrapolation:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">complex</span><span class="o">=</span><span class="n">Fragment</span><span class="p">(</span><span class="n">xyzfile</span><span class="o">=</span><span class="s1">&#39;ru-phosphine-complex.xyz&#39;</span><span class="p">)</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">CC_CBS_Theory</span><span class="p">(</span><span class="n">elements</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ru&quot;</span><span class="p">,</span> <span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;O&quot;</span><span class="p">,</span> <span class="s2">&quot;N&quot;</span> <span class="p">],</span> <span class="n">cardinals</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">basisfamily</span><span class="o">=</span><span class="s2">&quot;def2&quot;</span><span class="p">,</span> <span class="n">DLPNO</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">pnosetting</span><span class="o">=</span><span class="s1">&#39;NormalPNO&#39;</span><span class="p">,</span> <span class="n">numcores</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Singlepoint</span><span class="p">(</span><span class="n">theory</span><span class="o">=</span><span class="n">cc</span><span class="p">,</span> <span class="n">fragment</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example of a large ruthenium metal complex we can not afford to do regular CCSD(T) calculations and utilize instead the powerful local-correlation DLPNO approximation.
Here we use the def2 basis family and a def2-ECP effective core-potential will be automatically selected for ruthenium. We choose cardinals=[2,3] here and this means that we do the relatively cheap def2-SVP/def2-TZVPP extrapolation.
The DLPNO approximation utilizes thresholds that determine the accuracy of the DLPNO approximation (compared to unapproximated CCSD(T)).
By setting pnosetting=âNormalPNOâ we get the default PNO settings that are reasonably accurate. Other options are: âLoosePNOâ (not recommended) and âTightPNOâ (more accurate, more expensive), and âextrapolationâ (see below).</p>
<p><strong>Example: DLPNO-CCSD(T)/CBS with PNO extrapolation on a 4d-metal complex with the cc-pVnZ and cc-pVnZ-PP (n=3,4) extrapolation:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">complex</span><span class="o">=</span><span class="n">Fragment</span><span class="p">(</span><span class="n">xyzfile</span><span class="o">=</span><span class="s1">&#39;ru-phosphine-complex.xyz&#39;</span><span class="p">)</span>
<span class="c1">#Note: here providing list of elements more conveniently from the defined fragment</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">CC_CBS_Theory</span><span class="p">(</span><span class="n">elements</span><span class="o">=</span><span class="nb">complex</span><span class="o">.</span><span class="n">elems</span><span class="p">,</span> <span class="n">cardinals</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">basisfamily</span><span class="o">=</span><span class="s2">&quot;cc&quot;</span><span class="p">,</span> <span class="n">DLPNO</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">pnosetting</span><span class="o">=</span><span class="s1">&#39;extrapolation&#39;</span><span class="p">,</span> <span class="n">pnoextrapolation</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="n">numcores</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Singlepoint</span><span class="p">(</span><span class="n">theory</span><span class="o">=</span><span class="n">cc</span><span class="p">,</span> <span class="n">fragment</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
</pre></div>
</div>
<p>For an even more accurate estimate of the coupled-cluster basis set limit the [3,4] extrapolation is much more reliable than [2,3] and here we also utilize the more accurate
correlation-consistent basis set family (âccâ). For ruthenium, ASH tells ORCA to choose the cc-pVNZ-PP family for this heavy element and the âSK-MCDHFâ ECP.
To further reduce the error of the DLPNO approximation we use pnosetting=âextrapolationâ and pnoextrapolation=[6,7] which means that 2 DLPNO-CCSD(T) calculations will be performed
for each basis-set-cardinal calculation with different TCutPNO cutoffs (here TCutPNO=1e-6 and TCutPNO=1e-7). The results are then extrapolated to the PNO limit according to PNO extrapolation by Giovanni Bistoni and coworkers.
See these excellent papers: <a class="reference external" href="https://pubs.acs.org/doi/abs/10.1021/acs.jctc.0c00344">https://pubs.acs.org/doi/abs/10.1021/acs.jctc.0c00344</a> and <a class="reference external" href="https://pubs.acs.org/doi/abs/10.1021/acs.jpca.1c09106">https://pubs.acs.org/doi/abs/10.1021/acs.jpca.1c09106</a></p>
<p><strong>Example: DLPNO-CCSD(T)/CBS with PNO extrapolation on a 4d-metal complex with DKH relativistic approximation and cc-pwCVnZ-DK extrapolation:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">complex</span><span class="o">=</span><span class="n">Fragment</span><span class="p">(</span><span class="n">xyzfile</span><span class="o">=</span><span class="s1">&#39;ru-phosphine-complex.xyz&#39;</span><span class="p">)</span>
<span class="c1">#Note: here providing list of elements more conveniently from the defined fragment</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">CC_CBS_Theory</span><span class="p">(</span><span class="n">elements</span><span class="o">=</span><span class="nb">complex</span><span class="o">.</span><span class="n">elems</span><span class="p">,</span> <span class="n">cardinals</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">basisfamily</span><span class="o">=</span><span class="s2">&quot;cc-CV-dk&quot;</span><span class="p">,</span> <span class="n">DLPNO</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">relativity</span><span class="o">=</span><span class="s1">&#39;DKH&#39;</span><span class="p">,</span> <span class="n">pnosetting</span><span class="o">=</span><span class="s1">&#39;extrapolation&#39;</span><span class="p">,</span> <span class="n">pnoextrapolation</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="n">numcores</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Singlepoint</span><span class="p">(</span><span class="n">theory</span><span class="o">=</span><span class="n">cc</span><span class="p">,</span> <span class="n">fragment</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
</pre></div>
</div>
<p>While the cc-pVDZ-PP approach for ruthenium is affordable and accurate, for even greater accuracy one can opt for an all-electronic relativistic approach instead.
Here the Douglas-Kroll-Hess scalar relativistic Hamiltonian is used and this requires one to choose a basis-set family that has been recontracted for DKH Hamiltonians.
We could choose to use the âcc-dkâ but here we utilize the âcc-CV-dkâ family that in addition to being DKH-recontracted, features additional basis-functions typically used to describe core-valence
correlation. The frozen-core approximation is still in use here, meaning that the extra basis functions instead serve to improve the valence-electron correlation problem instead.</p>
<p><a class="reference external" href="https://pubs.acs.org/doi/abs/10.1021/acs.jctc.9b01109">https://pubs.acs.org/doi/abs/10.1021/acs.jctc.9b01109</a></p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="module_molcrys.html" class="btn btn-neutral float-right" title="MOLCRYS: Automatic QM/MM for Molecular Crystals" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="module_workflows.html" class="btn btn-neutral float-left" title="Workflows" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Ragnar Bjornsson.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>