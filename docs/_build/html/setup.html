<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Setup &mdash; Ash 0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/my_theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Basic usage" href="basics.html" />
    <link rel="prev" title="About ASH" href="About.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
            <a href="index.html" class="icon icon-home"> Ash
            <img src="_static/ash-simple-logo-letterbig.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">ASH</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="About.html">About ASH</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#a-download-ash">A. Download ASH</a></li>
<li class="toctree-l2"><a class="reference internal" href="#b-installation-and-configuration">B. Installation and Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#b0-the-lazy-impatient-way-to-set-up-ash-easy-but-incomplete">B0. The lazy/impatient way to set up ASH (easy but incomplete)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#b1-semi-automatic-miniconda-setup-easiest">B1. Semi-Automatic Miniconda setup (easiest)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#b2-semi-automatic-non-conda-setup">B2. Semi-Automatic non-Conda setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#b3-manual">B3. Manual</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#c-install-external-programs">C. Install External Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#d-test-ash">D. Test ASH</a></li>
<li class="toctree-l2"><a class="reference internal" href="#e-installation-problems">E. Installation problems</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Basic usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic-examples.html">Basic examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="ash_program_philosophy.html">ASH Program Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="coordinate-input.html">Coordinates and fragments</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallelization.html">Parallelization in ASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="QM-interfaces.html">QM Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="MM-interfaces.html">MM Interfaces</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Jobtypes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="job-types.html">Job Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="singlepoint.html">Singlepoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="Geometry-optimization.html">Geometry optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_freq.html">Frequency calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_dynamics.html">Molecular dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="neb.html">Nudged Elastic Band Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="surfacescan.html">Surface Scans</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="module_QM-MM.html">QM/MM Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_Hybrid_Theory.html">Hybrid Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_benchmarking.html">Benchmarking in ASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_workflows.html">Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_highlevel_workflows.html">Highlevel workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_molcrys.html">MOLCRYS: Automatic QM/MM for Molecular Crystals</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_PES.html">PES: PhotoElectron/PhotoEmission Spectrum</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_plotting.html">Plotting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Interfaces</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ORCA-interface.html">ORCA interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="xTB-interface.html">xTB interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="MRCC-interface.html">MRCC interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="CFour-interface.html">CFour interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dalton-interface.html">Dalton interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="PySCF-interface.html">PySCF interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Psi4-interface.html">Psi4 interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="crest-interface.html">CREST interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="OpenMM-interface.html">OpenMM interface</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Explicit-solvation.html">Explicit solvation (small molecule)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metalloprotein-I.html">Metalloprotein tutorial I: Rubredoxin</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metalloprotein-II.html">Metalloprotein tutorial II: Ferredoxin</a></li>
<li class="toctree-l1"><a class="reference internal" href="QM-MM-protein.html">QM/MM on a protein</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflows-examples.html">Workflow examples in ASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="Highlevel_CC_CBS_workflows.html">Tutorial: High-level CCSD(T)/CBS workflows</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="coordinate-tools.html">Coordinates and fragment tools</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Ash</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Setup</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/setup.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <style> .red {color:#aa0060; font-weight:bold; font-size:16px} </style><div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline"></a></h1>
<p>To install/setup ASH you need to download the code from the <a class="reference external" href="https://github.com/RagnarB83/ash">Github</a> repository.</p>
<p>ASH is 99% Python with 1 % Julia.
A Python3 distribution (version &gt;3.6 or higher) is required and you need to be able to install Python packages via conda or pip.</p>
<p>Scientific Python distributions like Anaconda/miniconda can be convenient: <a class="reference external" href="https://www.anaconda.com/distribution/">https://www.anaconda.com/distribution/</a>
Anaconda comes with Numpy, SciPy, Matplotlib.</p>
<p>Some functionality (primarily the molecular crystal QM/MM part) require a Julia installation (as the Python routines will be too slow).
Future versions may make the Julia interface a requirement.</p>
<p>Strict dependencies:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.python.org">Python version 3.6</a> or higher</p></li>
<li><p><a class="reference external" href="https://numpy.org">Numpy</a> library.</p></li>
</ul>
<p>Strongly recommended (necessary for some ASH functionality):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/leeping/geomeTRIC">geomeTRIC</a> (Python package via pip). Required for geometry optimizations.</p></li>
<li><p><a class="reference external" href="http://openmm.org">OpenMM</a> version 7.6 or later. Required for most MM and MD functionality in ASH.</p></li>
<li><p><a class="reference external" href="https://julialang.org/downloads">Julia 1.7</a> installation for fast routines in MolCrys QM/MM</p></li>
<li><p>Python-Julia library: <a class="reference external" href="https://cjdoris.github.io/PythonCall.jl/stable/pycall/">PythonCall</a> or <a class="reference external" href="https://pyjulia.readthedocs.io/en/latest/">PyJulia</a></p></li>
</ul>
<p>Recommended external codes (most ASH examples will use these):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://xtb-docs.readthedocs.io/en/latest/">xTB</a> The semi-empirical tightbinding DFT code by Grimme and coworkers.</p></li>
<li><p><a class="reference external" href="https://orcaforum.kofo.mpg.de">ORCA</a> The popular free-for-academic-use HF,DFT,WFT program by Neese and coworkers.</p></li>
</ul>
<p>Useful libraries for specific functionality:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://matplotlib.org">Matplotlib</a> library. Used to plot graphs/surfaces.</p></li>
<li><p><a class="reference external" href="https://www.scipy.org">Scipy</a> library. Used for interpolation routines when plotting surfaces and in molecular crystal QM/MM.</p></li>
<li><p><a class="reference external" href="https://www.plumed.org">Plumed</a> Plumed library</p></li>
<li><p><a class="reference external" href="https://parmed.github.io/ParmEd/html/index.html">Parmed</a> May be used by OpenMM interface.</p></li>
<li><p><a class="reference external" href="https://www.mdanalysis.org">MDAnalysis</a> MD trajectory analysis</p></li>
<li><p><a class="reference external" href="https://www.mdtraj.org">MDtraj</a> MD trajectory analysis</p></li>
<li><p><a class="reference external" href="https://wiki.fysik.dtu.dk/ase/">ASE</a> Atomic Simulation Environment</p></li>
</ul>
<div class="section" id="a-download-ash">
<h2>A. Download ASH<a class="headerlink" href="#a-download-ash" title="Permalink to this headline"></a></h2>
<p>Clone or download the archive from <a class="reference external" href="https://github.com/RagnarB83/ash">Github</a> containing ASH and put the directory (named ash) in some appropriate location.
The ash directory contains the Python source code files, e.g. ash_header.py and several directories.</p>
</div>
<div class="section" id="b-installation-and-configuration">
<h2>B. Installation and Configuration<a class="headerlink" href="#b-installation-and-configuration" title="Permalink to this headline"></a></h2>
<div class="section" id="b0-the-lazy-impatient-way-to-set-up-ash-easy-but-incomplete">
<h3>B0. The lazy/impatient way to set up ASH (easy but incomplete)<a class="headerlink" href="#b0-the-lazy-impatient-way-to-set-up-ash-easy-but-incomplete" title="Permalink to this headline"></a></h3>
<p>If you are impatient and want to get ASH going immediately without all features enabled.</p>
<ol class="arabic simple">
<li><p>Download the ASH repository from <a class="reference external" href="https://github.com/RagnarB83/ash">Github</a></p></li>
<li><p>Make sure there is a python3 interpreter on your system (with numpy)</p></li>
<li><p>Set: export PYTHONPATH=/path/to/ash:$PYTHONPATH   (where /path/to/ash is the directory containing the source-code directory (called “ash”))</p></li>
<li><p>Test ASH by launching: <strong>python3</strong>  and then do: from ash import *        (this will fail if PYTHONPATH is set incorrectly)</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ASH will complain when you try to use features that require additional installations (e.g. geometric, julia, OpenMM etc)</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If your installation path is e.g. /home/ragnar/ASH-program/ash  (where the ash directory contains bunch of files including ash_header.py) then you should set PYTHONPATH like this: export PYTHONPATH=/home/ragnar/ASH-program:$PYTHONPATH   but NOT:  export PYTHONPATH=/home/ragnar/ASH-program/ash:$PYTHONPATH</p>
</div>
</div>
<div class="section" id="b1-semi-automatic-miniconda-setup-easiest">
<h3>B1. Semi-Automatic Miniconda setup (easiest)<a class="headerlink" href="#b1-semi-automatic-miniconda-setup-easiest" title="Permalink to this headline"></a></h3>
<p>This is the recommended way. Required if you intend to do MM or QM/MM using the OpenMM package (as OpenMM has to be installed via conda/miniconda).</p>
<ol class="arabic simple">
<li><p>Install <a class="reference external" href="https://docs.conda.io/en/latest/miniconda.html">Miniconda</a>.  Install it in a location where your user has access (e.g. your home-directory)</p></li>
<li><p>Create new environment (not required but recommended): <strong>conda create –name ASH</strong></p></li>
<li><p>Load environment: <strong>conda activate ASH</strong></p></li>
<li><p>Change directory to ASH location</p></li>
<li><p>Install all desired packages listed in: ASH-packages.sh (inside ASH source code directory) via conda or pip (conda is preferred).</p></li>
<li><p>Make sure the chosen Python-Julia interface works. PythonCall/JuliaCall is recommended, PyJulia is another option. See Section B3: Step 5a and 5b below for details.</p></li>
<li><p>Optional: Run: <strong>julia julia-packages-setup.jl</strong> to install some required Julia packages. Note: Julia dependency only required for molecular-crystal QM/MM.</p></li>
<li><p>Run: <strong>bash conda_setup_ash.sh</strong> # This creates new files: set_environment_ash.sh and python3_ash</p></li>
<li><p>Run: <strong>source set_environment_ash.sh</strong>  (this sets necessary PATHs and should probably be put in each user’s .bash_profile, job-submission script etc.)</p></li>
<li><p>Test ASH by launching: <strong>python3</strong>  and then do: from ash import *</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>if PyJulia interface was specifically installed (not recommended) you must use <strong>python-jl</strong> for ASH to correctly call Julia routines.</p>
</div>
</div>
<div class="section" id="b2-semi-automatic-non-conda-setup">
<h3>B2. Semi-Automatic non-Conda setup<a class="headerlink" href="#b2-semi-automatic-non-conda-setup" title="Permalink to this headline"></a></h3>
<p>This option is not recommended if you intend to use ASH and OpenMM for MM, MD and QM/MM functionality.
This is because OpenMM is only easily installable via conda. See section B1 above.</p>
<p>This uses the nonconda_install_ash.sh script inside the ASH directory.
The script downloads and installs Python packages (numpy, geometric,pyjulia) as well as Julia and packages and creates a convenient script for setting up the ASH environment. It requires a working Python3 installation.</p>
<p><strong>Step 1.</strong> Make sure the desired python3 is in your environment (‘which python3’ in the shell) or set path_to_python3_dir in the ./nonconda_install_ash.sh script to the Python3 installation you want to use. Script has a few possible settings in the beginning.
Note: You need to be able to install packages to this installation via pip</p>
<p><strong>Step 2.</strong> cd to ASH directory, make nonconda_install_ash.sh executable and run:</p>
<ul class="simple">
<li><p>chmod +x ./nonconda_install_ash.sh</p></li>
<li><p>./nonconda_install_ash.sh</p></li>
</ul>
<p><strong>Step 3.</strong> If installation is successful:</p>
<ul class="simple">
<li><p>source ./set_environment_ash.sh    to activate ASH environment.</p></li>
</ul>
</div>
<div class="section" id="b3-manual">
<h3>B3. Manual<a class="headerlink" href="#b3-manual" title="Permalink to this headline"></a></h3>
<p>(Use only if semi-automatic approach B1 or B2 does not work)</p>
<p><strong>Step 1.</strong></p>
<p>Make sure ASH has been downloaded and moved to some location where it will stay.
The location of the ASH directory will be referred to as /path/to/ash below (substitute /path/to/ash for the actual location on your machine).</p>
<p><strong>Step 2.</strong></p>
<p>Check if a suitable Python3 installation is available (globally available or maybe via a module on your cluster). It needs to be relatively new (version 3.6 and above) contain Numpy and you will need to be able to install Python packages to it using the package manager pip.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1">#Check where python3 is:</span>
which python3
<span class="c1">#Check Python3 version</span>
python3 --version
<span class="c1">#Check that pip/pip3 is available (sometimes pip3 should be called instead of pip)</span>
which pip3  <span class="c1">#Make sure the pip path is the same as python3 path)</span>
<span class="c1">#Check that numpy is available inside the Python3 installation</span>
pip3 list <span class="p">|</span> grep numpy
</pre></div>
</div>
<p>If you have a suitable Python3 with numpy then make sure it is loaded in your environment when using ASH.
An Anaconda/miniconda distribution can be used. Make sure the conda environment is loaded.</p>
<p>If you don’t already have a suitable Python3 distribution, go to Step 2b.</p>
<p><strong>Step 2b. Install Python if required</strong></p>
<p><em>Option 1: Python3 via system package manager</em></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This option might be preferred if installing on a cluster for multiple users.</p>
</div>
<p>Linux: Install Python3 via a Linux package manager (e.g. Centos: yum -y install python3, Ubuntu: apt install python3).
Installing via a package manager is prefereable than compiling from source (see python.org for compile options).
Mac OS X: TODO
Windows: TODO</p>
<p>Install numpy via pip:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip3 install numpy
</pre></div>
</div>
<p>Make sure that the Python3 that you have installed is in your PATH environment while finishing the setup process and when using ASH:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span>/path/to/python3/bin:<span class="nv">$PATH</span>
</pre></div>
</div>
<p><em>Option 2: Anaconda/Miniconda Python3 setup</em></p>
<p>Download <a class="reference external" href="https://www.anaconda.com/products/individual">Anaconda Python3 package</a> or <a class="reference external" href="https://docs.conda.io/en/latest/miniconda.html">Miniconda</a> and install in e.g. your user directory.
Follow Anaconda/Miniconda installation instructions. Install numpy unless already installed. It could be a good idea to create your own conda environment for ASH but this is not strictly necessary.</p>
<p><strong>Step 3.</strong> To make ASH available to Python3, set the environment variables:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">ASHPATH</span><span class="o">=</span>/path/to/ash  <span class="c1"># Change /path/to/ash to the actual ASH directory location on your machine</span>
<span class="nb">export</span> <span class="nv">PYTHONPATH</span><span class="o">=</span><span class="nv">$ASHPATH</span>:<span class="nv">$ASHPATH</span>/lib:<span class="nv">$PYTHONPATH</span>
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$ASHPATH</span>:<span class="nv">$PATH</span>
<span class="nb">export</span> <span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$ASHPATH</span>/lib:<span class="nv">$LD_LIBRARY_PATH</span>
</pre></div>
</div>
<p>where <em>/path/to/ash</em> is the dir that contains the “ash” source-code diretory .
Put these environment definitions in your shell environment startup file e.g. .bashrc, .bash_profile or .zshrc.
This step will be necessary for each user on the cluster.</p>
<p><strong>Step 4.</strong> Install the recommended Python packages via pip/pip3:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip3 install geometric   <span class="o">(</span>geomeTRIC optimizer<span class="o">)</span>
</pre></div>
</div>
<p>This requires you to be able ot install packages to your Python installation. It may also be possible to install Python packages
locally to your user’s home directory by the “–user” option:  pip3 install geometric –user</p>
<p><strong>Step 5a.</strong> Install Julia from the <a class="reference external" href="https://julialang.org/downloads">Julia official site</a>.</p>
<p>Julia is necessary for some fast QM/MM functionality inside ASH (e.g. Molcrys). This step can be skipped if you won’t be using the molecular crystal QM/MM feature.</p>
<blockquote>
<div><ol class="lowerroman simple">
<li><p>Download appropriate binaries from the official Julia website. Version 1.7 or higher. Extract archive.</p></li>
<li><p>Add Julia binaries to path: e.g. export PATH=/path/to/julia-1.7.1/bin:$PATH . Put this PATH definition in your shell startup file.</p></li>
<li><p>Run Julia using the ASH sourcefile julia-packages-setup.jl (inside ASH source directory) as input to download and install the  required Julia packages. Currently: PyCall, Hungarian, Distances</p></li>
</ol>
</div></blockquote>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>julia julia-packages-setup.jl  <span class="c1">#This launches the julia interpreter and requests installation of required Julia packages for ASH.</span>
</pre></div>
</div>
<p>This will download and install required Julia packages.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To avoid having to setup the Julia packages for each user on a computing cluster, one can specify a global Julia package-store-location: export JULIA_DEPOT_PATH=/path/to/julia-packages-dir  before running :  julia julia-packages-setup.jl</p>
</div>
<p>If there is an error like this: ERROR: SystemError: opening file “/path/to/.julia/registries/General/Registry.toml”: No such file or directory
Then execute in shell: rm -rf ~/.julia/registries/General</p>
<p><strong>Step 5b.</strong> Install Julia-Python interface</p>
<p>ASH requires a Python-Julia library in order to enable communication between Python and Julia.
The options are: <a class="reference external" href="https://cjdoris.github.io/PythonCall.jl/stable/pycall/">PythonCall</a> and <a class="reference external" href="https://pyjulia.readthedocs.io/en/latest/">PyJulia</a>
ASH currently supports both but the newer PythonCall is currently recommended due to PyJulia currently requiring to call ASH with a modified Python interpreter (python-jl) due to static libpython issues.</p>
<p><span class="red">Important:</span> Make sure the correct Python environment is active before proceeding. Check that the pip or pip3 executable is available and corresponds to the Python you want:</p>
<p><span class="red">Important:</span> Make sure the Julia executable is in your PATH already.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>which pip
which pip3
</pre></div>
</div>
<p>Then install using pip/pip3:</p>
<p><strong>PythonCall/JuliaCall option:</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip3 install juliacall
</pre></div>
</div>
<p>Once juliacall is installed, check that it is working correctly by:</p>
<ol class="arabic simple">
<li><p>Launch python3 interactive session :</p></li>
</ol>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>python3 <span class="c1"># in shell</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Run in python3 session:</p></li>
</ol>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">juliacall</span>   <span class="c1">#This will try to import the PythonCall/Juliacall interface, will check for Julia availability etc.</span>
<span class="n">juliacall</span><span class="o">.</span><span class="n">Main</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">34.5</span><span class="p">)</span> <span class="c1">#This will call the Julia sin function.</span>
</pre></div>
</div>
<p>If no errors then things should be good to go for ASH.</p>
<p><strong>PyJulia option:</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip3 install julia
</pre></div>
</div>
<ul class="simple">
<li><p>The Pyjulia executable, <em>python-jl</em> (available after pip3 install julia) must generally be used if Julia routines are called by ASH. It is needed for the PyJulia interface to work properly.</p></li>
<li><p>Make sure the correct Python3 environment is active. Otherwise ASH will not work.</p></li>
<li><p>The regular Python3 executable, <em>python3</em>  can also be used to run ASH scripts and is recommended if you don’t require ASH to launch Julia routines (molcrystal-QM/MM primarily). There may be warnings about the Python-Julia-interface not working. These warnings can be ignored . For large systems or when using QM/MM-Molcrys, this is not a good option, however, as very slow Python routines will be used for time-consuming steps.</p></li>
</ul>
</div>
</div>
<div class="section" id="c-install-external-programs">
<h2>C. Install External Programs<a class="headerlink" href="#c-install-external-programs" title="Permalink to this headline"></a></h2>
<p>See also ASH-packages.sh in ASH source code directory!</p>
<p><strong>Step 1.</strong> Install desired QM program(s):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://orcaforum.kofo.mpg.de">ORCA</a> is a recommended QM code (flexible interface in ASH). See installation instructions on the <a class="reference external" href="https://sites.google.com/site/orcainputlibrary/setting-up-orca">ORCA Input Library</a>. The path to ORCA needs to be in PATH and LD_LIBRARY_PATH of your shell and later your jobscript.</p></li>
<li><p><a class="reference external" href="https://xtb-docs.readthedocs.io">xTB</a> needs to be in PATH and later your jobscript.</p></li>
</ul>
<p>Optional Python packages to install via pip (depends on whether you will use the interfaces to PySCF and PyFrame):</p>
<ul class="simple">
<li><p><a class="reference external" href="http://www.pyscf.org/">PySCF</a></p></li>
<li><p><a class="reference external" href="https://gitlab.com/FraME-projects/PyFraME">PyFrame</a>:</p></li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip3 install pyscf       <span class="c1">#PySCF QM program</span>
pip3 install pyframe     <span class="c1">#polarizable embedding helper tool</span>
</pre></div>
</div>
<p>Optional installation of the <a class="reference external" href="http://www.psicode.org/">Psi4</a> QM code (if you intend to use it), best done via Conda:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>conda install psi4 psi4-rt -c psi4
</pre></div>
</div>
<p><strong>Step 2.</strong> Optional: Install OpenMM</p>
<p>For general MM, QM/MM and MD functionality in ASH,  the <a class="reference external" href="http://openmm.org">OpenMM program</a> must be available.
It can be installed using conda.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>conda install -c conda-forge openmm
</pre></div>
</div>
</div>
<div class="section" id="d-test-ash">
<h2>D. Test ASH<a class="headerlink" href="#d-test-ash" title="Permalink to this headline"></a></h2>
<p>Test if things work in general:
python3 /path/to/ash/ash/test_ash.py   #This runs a basic test job using the regular Python interpreter
python-jl /path/to/ash/ash/test_ash.py   #Only required when PyJulia is used</p>
<p>Example ASH script to try out with an external QM code (geometry optimization of H2O using ORCA):</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>python3 first-ash-job.py
</pre></div>
</div>
<p>first-ash-job.py:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ash</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1">#Create H2O fragment</span>
<span class="n">coords</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">O       -1.377626260      0.000000000     -1.740199718</span>
<span class="s2">H       -1.377626260      0.759337000     -1.144156718</span>
<span class="s2">H       -1.377626260     -0.759337000     -1.144156718</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">H2O</span><span class="o">=</span><span class="n">Fragment</span><span class="p">(</span><span class="n">coordsstring</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mult</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#Defining ORCA-related variables</span>
<span class="n">orcasimpleinput</span><span class="o">=</span><span class="s2">&quot;! BP86 def2-SVP def2/J tightscf&quot;</span>

<span class="n">ORCAcalc</span> <span class="o">=</span> <span class="n">ORCATheory</span><span class="p">(</span><span class="n">orcasimpleinput</span><span class="o">=</span><span class="n">orcasimpleinput</span><span class="p">)</span>

<span class="c1">#Geometry optimization</span>
<span class="n">geomeTRICOptimizer</span><span class="p">(</span><span class="n">fragment</span><span class="o">=</span><span class="n">H2O</span><span class="p">,</span> <span class="n">theory</span><span class="o">=</span><span class="n">ORCAcalc</span><span class="p">,</span> <span class="n">coordsystem</span><span class="o">=</span><span class="s1">&#39;tric&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="e-installation-problems">
<h2>E. Installation problems<a class="headerlink" href="#e-installation-problems" title="Permalink to this headline"></a></h2>
<p><strong>python-jl (PyJulia) problem</strong></p>
<p>If you get an error message when launching python-jl (only when PyJulia has been installed) that looks like the following:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>File &quot;/home/bjornsson/ash/python3_ash&quot;, line 9, in &lt;module&gt;
sys.exit(main())
File &quot;/home/bjornsson/.local/lib/python3.8/site-packages/julia/python_jl.py&quot;, line 114, in main
execprog([julia, &quot;-e&quot;, script_jl, &quot;--&quot;] + unused_args)
...
FileNotFoundError: [Errno 2] No such file or directory
</pre></div>
</div>
<p>This means that the Python-Julia interface is not completely working.
Check the following:</p>
<ol class="arabic simple">
<li><p>Is Julia accessible from the shell?, i.e. does typing <em>julia</em> in the shell, launch the Julia interpreter ? If not then the PATH to Julia bin dir needs to set: export PATH=/path/to/julia/bin:$PATH</p></li>
<li><p>Something went wrong in the installation of Julia or PyJulia. Go through these steps again.</p></li>
<li><p>Make sure you are using the same Python environment you used when you installed things.</p></li>
<li><p>Set up PyCall for each Julia user environment (this updates ~/.julia dir)</p></li>
</ol>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="About.html" class="btn btn-neutral float-left" title="About ASH" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="basics.html" class="btn btn-neutral float-right" title="Basic usage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Ragnar Bjornsson.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXX-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-XXXXXXX-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>