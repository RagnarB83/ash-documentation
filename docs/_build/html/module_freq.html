

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Frequency calculation &mdash; Ash 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/my_theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Molecular dynamics" href="module_dynamics.html" />
    <link rel="prev" title="Singlepoint" href="singlepoint.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="index.html" class="icon icon-home"> Ash
          

          
            
            <img src="_static/ash-simple-logo-letterbig.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">ASH</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="About.html">About ASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Basic usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic-examples.html">Basic examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="ash_program_philosophy.html">ASH Program Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="coordinate-input.html">Coordinates and fragments</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallelization.html">Parallelization in ASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="QM-interfaces.html">QM Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="MM-interfaces.html">MM Interfaces</a></li>
</ul>
<p class="caption"><span class="caption-text">Jobtypes</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="job-types.html">Job Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="singlepoint.html">Singlepoint</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Frequency calculation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#numerical-frequencies">Numerical frequencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#analytical-frequencies">Analytical frequencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#thermochemistry-corrections">thermochemistry corrections</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="module_dynamics.html">Molecular dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="neb.html">Nudged Elastic Band Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="surfacescan.html">Surface Scans</a></li>
</ul>
<p class="caption"><span class="caption-text">Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="module_QM-MM.html">QM/MM Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_benchmarking.html">Benchmarking in ASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_workflows.html">Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_highlevel_workflows.html">Highlevel workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_molcrys.html">MOLCRYS: Automatic QM/MM for Molecular Crystals</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_PES.html">PES: PhotoElectron/PhotoEmission Spectrum</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_plotting.html">Plotting</a></li>
</ul>
<p class="caption"><span class="caption-text">Interfaces</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ORCA-interface.html">ORCA interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="xTB-interface.html">xTB interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="MRCC-interface.html">MRCC interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="CFour-interface.html">CFour interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dalton-interface.html">Dalton interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="PySCF-interface.html">PySCF interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Psi4-interface.html">Psi4 interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="crest-interface.html">CREST interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="geomeTRIC-interface.html">geomeTRIC interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="knarr-interface.html">KNARR interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="OpenMM-interface.html">OpenMM interface</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Explicit-solvation.html">Explicit solvation (small molecule)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metalloprotein-I.html">Metalloprotein tutorial I: Rubredoxin</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metalloprotein-II.html">Metalloprotein tutorial II: Ferredoxin</a></li>
<li class="toctree-l1"><a class="reference internal" href="QM-MM-protein.html">QM/MM on a protein</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflows-examples.html">Workflow examples in ASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="Highlevel_CC_CBS_workflows.html">Tutorial: High-level CCSD(T)/CBS workflows</a></li>
</ul>
<p class="caption"><span class="caption-text">Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="coordinate-tools.html">Coordinates and fragment tools</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Ash</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Frequency calculation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/module_freq.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="frequency-calculation">
<h1>Frequency calculation<a class="headerlink" href="#frequency-calculation" title="Permalink to this headline">¶</a></h1>
<p>A frequency calculation can be performed either numerically or analytically. The numerical approach is highly general and can always be applied to any QM, MM or QM/MM theory while the analytical approach
is only available if the QM program contains the functionality.
For QM/MM Hamiltonians, the numerical approach is currently the only available option.</p>
<div class="section" id="numerical-frequencies">
<h2>Numerical frequencies<a class="headerlink" href="#numerical-frequencies" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">NumFreq</span><span class="p">(</span><span class="n">fragment</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">theory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">npoint</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">displacement</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">hessatoms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">numcores</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">runmode</span><span class="o">=</span><span class="s1">&#39;serial&#39;</span><span class="p">,</span>
        <span class="n">temp</span><span class="o">=</span><span class="mf">298.15</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">hessatoms_masses</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">printlevel</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mult</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</pre></div>
</div>
<p><strong>NumFreq</strong> options:</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Keyword</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default value</p></th>
<th class="head"><p>Details</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">fragment</span></code></p></td>
<td><p>ASH Fragment</p></td>
<td><p>None</p></td>
<td><p>ASH Fragment object.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">theory</span></code></p></td>
<td><p>ASHTheory object</p></td>
<td><p>None</p></td>
<td><p>ASH Theory object.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">runmode</span></code></p></td>
<td><p>String</p></td>
<td><p>‘serial</p></td>
<td><p>Whether to run the numerical frequency displacement calculations in serial (sequentially) or in parallel using Python multiprocessing.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">npoint</span></code></p></td>
<td><p>Integer</p></td>
<td><p>2</p></td>
<td><p>Whether to do a 1-point or 2-point approximation for the Hessian. 1-point takes half as many displacements as 2-point and is less accurate.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">displacement</span></code></p></td>
<td><p>Float</p></td>
<td><p>0.005</p></td>
<td><p>Size of displacement (in Å) to take.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hessatoms</span></code></p></td>
<td><p>list</p></td>
<td><p>None</p></td>
<td><p>Optional list of atom indices that will be displaced and define a partial Hessian instead of a full Hessian. If None, all atoms in Fragment will be displaced.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">temp</span></code></p></td>
<td><p>Float</p></td>
<td><p>298.15</p></td>
<td><p>Temperature (in K) to use in thermochemistry calculation.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pressure</span></code></p></td>
<td><p>Float</p></td>
<td><p>1.0</p></td>
<td><p>Pressure (in atm) to use in thermochemistry calculation.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hessatoms_masses</span></code></p></td>
<td><p>list</p></td>
<td><p>None</p></td>
<td><p>Optional list of masses for the Hessian atoms.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">charge</span></code></p></td>
<td><p>integer</p></td>
<td><p>None</p></td>
<td><p>Optional charge. Will override charge attribute of ASH Fragment.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">mult</span></code></p></td>
<td><p>integer</p></td>
<td><p>None</p></td>
<td><p>Optional spin multiplicity. Will override mult attribute of ASH Fragment.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">printlevel</span></code></p></td>
<td><p>integer</p></td>
<td><p>1</p></td>
<td><p>The printlevel.</p></td>
</tr>
</tbody>
</table>
<p>Numerical frequencies can be performed with ASH using any QM, MM or QM/MM theory object.
Any method for which there is an analytical gradient (forces) available (in the external code) can be used (numerical 2nd derivative on top of numerical 1st derivative is not recommended).</p>
<p>Use the <strong>NumFreq</strong> function to request a numerical frequency job. The function requires a fragment object and a theory level at minimum.
The fragment object should typically contain a fragment with optimized coordinates at same level of theory (i.e. an already optimized minimum or saddlepoint).</p>
<p><em>Type of Hessian</em></p>
<p>Additionally you can select to do a 1-point Hessian or a 2-point Hessian by the <em>npoint</em> keyword (value of 1 or 2).
A 1-point Hessian makes a single displacement (+ direction) for each atom and each x,y and z-coordinate from the input geometry. This option is reasonably accurate and is the default.
A more accurate 2-point Hessian makes displacement in both + and - directions (for each x-, y- and z-coordinate of each atom), is twice as expensive (double the displacements)
but is more accurate.
The displacement step can be changed if required. The default recommended setting is: 0.0005 Å.</p>
<p><em>Serial or parallel</em></p>
<p>Two runmodes are available: ‘serial’ and ‘parallel’. The ‘serial’ mode will run each displacement sequentially.
The Energy+Gradient step can still be run in parallel if e.g. the QM or QM/MM object has this information;
e.g. if an ORCA object has been defined with numcores=8 then ORCA will run each Energy+Gradient evaluation with 8 cores using the OpenMPI parallelization of ORCA.
For numerical frequencies, it is usually much more efficient, however, to run the displacement jobs simutaneously in parallel fashion.
This is accomplished using runmode=’parallel’ and the parallelization will be linear scaling (almost always recommended).
As there are almost always many more displacements available than CPUs, the parallelization of the QM or QM/MM object is turned off and instead as many displacements
are run simultaneously as there are number of cores. For example, for a 30-atom system, there are 90 XYZ coordinates. For a 2-point Hessian, this means
that 180 displacements to be calculated. If 20 cores are available, then 20 displacements can be run simultaneously, fully utilizing all 20 cores.
This will require 9 runs in total (20*9=180).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Parallel runmode is currently not available for QM/MM calculations.</p>
</div>
<p><em>Full or partial Hessian</em></p>
<p>A partial Hessian can be easily performed instead of the full Hessian. This is an excellent approximation for vibrational modes with rather local character
and the quality of the approximation can be controlled. For a QM/MM model of a protein active site with an active region of a 1000 atoms, the full Hessian
of all 1000 atoms would typically not be a doable or recommended calculation; instead a partial Hessian job of the important atoms (e.g. the QM region) makes more sense.
A partial Hessian job is performed if a list of Hessian atoms (e.g. hessatoms=[0,1,2] ) is passed to the NumFreq function. In this case, the displacements
will only be calculated for the list of “hessatoms” and the result is a partial Hessian for the chosen atoms of the system</p>
<p><em>Final output</em></p>
<p>Once the displacements are complete, the gradients for all displacements are combined to give the full (or partial) Hessian.
The Hessian is then mass-weighted and diagonalized. (Limitation: translational and rotational modes are currently not projected out).
This gives the frequencies as eigenvalues and the normal mode eigenvectors.
A normal mode composition factor analysis is automatically performed as well as thermochemistry based on the rigid-rotor-harmonic-oscillator (RRHO) approximation.</p>
<p>Example script below demonstrates a combined geometry optimization (using geomeTRIC).
The QM code used here is ORCA but any QM, MM or QM/MM object can be used.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ash</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1">#the total number of CPU cores available to Ash (should match the job-script)</span>
<span class="n">numcores</span><span class="o">=</span><span class="mi">8</span>

<span class="n">orcasimpleinput</span><span class="o">=</span><span class="s2">&quot;! HF-3c &quot;</span>
<span class="n">orcablocks</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">cf maxiter 200 end&quot;</span>

<span class="n">reactstring</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">   C  -2.66064921   -0.44148342    0.02830018</span>
<span class="s2">   H  -2.26377685   -1.23173358    0.68710920</span>
<span class="s2">   H  -2.29485851   -0.62084858   -0.99570465</span>
<span class="s2">   H  -2.27350346    0.53131334    0.37379014</span>
<span class="s2">   F  -4.03235214   -0.44462811    0.05296388</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">Reactant</span><span class="o">=</span><span class="n">Fragment</span><span class="p">(</span><span class="n">coordsstring</span><span class="o">=</span><span class="n">reactstring</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mult</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#Calculator object without frag. numcores=8 is used here for parallelizing ORCA during optimization.</span>
<span class="n">ORCAcalc</span> <span class="o">=</span> <span class="n">ORCATheory</span><span class="p">(</span><span class="n">orcasimpleinput</span><span class="o">=</span><span class="n">orcasimpleinput</span><span class="p">,</span> <span class="n">orcablocks</span><span class="o">=</span><span class="n">orcablocks</span><span class="p">,</span> <span class="n">numcores</span><span class="o">=</span><span class="n">numcores</span><span class="p">)</span>

<span class="c1">#Geometry optimization of Reactant object and ORCAcalc theory object.</span>
<span class="c1">#Each Energy+Grad step is parallelized by ORCA.</span>
<span class="n">geomeTRICOptimizer</span><span class="p">(</span><span class="n">theory</span><span class="o">=</span><span class="n">ORCAcalc</span><span class="p">,</span><span class="n">fragment</span><span class="o">=</span><span class="n">Reactant</span><span class="p">)</span>


<span class="c1">#Numfreq job. A 1-point or 2-point Hessian can be requested.</span>
<span class="c1"># Either serial or parallell runmode can be used.</span>
<span class="c1"># For parallel: Ash will use the number of cores given to run same number of displacments simultaneouslyu.</span>
<span class="c1">#ORCA parallelization is turned off automatically.</span>

<span class="c1">#Serial mode:</span>
<span class="n">freqresult</span> <span class="o">=</span> <span class="n">NumFreq</span><span class="p">(</span><span class="n">fragment</span><span class="o">=</span><span class="n">Reactant</span><span class="p">,</span> <span class="n">theory</span><span class="o">=</span><span class="n">ORCAcalc</span><span class="p">,</span> <span class="n">npoint</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">runmode</span><span class="o">=</span><span class="s1">&#39;serial&#39;</span><span class="p">)</span>
<span class="c1">#Parallel mode:</span>
<span class="n">freqresult</span> <span class="o">=</span> <span class="n">NumFreq</span><span class="p">(</span><span class="n">fragment</span><span class="o">=</span><span class="n">Reactant</span><span class="p">,</span> <span class="n">theory</span><span class="o">=</span><span class="n">ORCAcalc</span><span class="p">,</span> <span class="n">npoint</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">runmode</span><span class="o">=</span><span class="s1">&#39;parallel&#39;</span><span class="p">,</span> <span class="n">numcores</span><span class="o">=</span><span class="n">numcores</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;freqresult:&quot;</span><span class="p">,</span> <span class="n">freqresult</span><span class="p">)</span>
<span class="c1">#The resulting object from a NumFreq calculation is a dictionary (here called freqresult)</span>
<span class="c1"># It contains the calculated frequencies and results from the Thermochemical analysis.</span>
<span class="c1">#Individual items from the dictionary can be accessed by specifying the dictionary key:</span>
<span class="c1"># Available keys: frequencies, ZPVE, vibenergy, transenergy, rotenergy, vibenergy, vibenergycorr</span>
<span class="c1"># TO BE FINISHED...</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Frequencies : &quot;</span><span class="p">,</span> <span class="n">freqresult</span><span class="p">[</span><span class="s1">&#39;frequencies&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ZPVE : &quot;</span><span class="p">,</span> <span class="n">freqresult</span><span class="p">[</span><span class="s1">&#39;ZPVE&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="analytical-frequencies">
<h2>Analytical frequencies<a class="headerlink" href="#analytical-frequencies" title="Permalink to this headline">¶</a></h2>
<p>Some QM programs have analytical frequencies implemented and the ASH interface may support requesting the calculation of the analytical Hessian.
Currently analytical frequencies are supported in the QM codes: ORCATheory</p>
<p>An analytical Hessian calculation is requested by the AnFreq function that takes fragment and theory as necessary arguments:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">AnFreq</span><span class="p">(</span><span class="n">fragment</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">theory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">numcores</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="mf">298.15</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">HF_frag</span><span class="o">=</span><span class="n">Fragment</span><span class="p">(</span><span class="n">xyzfile</span><span class="o">=</span><span class="s2">&quot;hf.xyz&quot;</span><span class="p">)</span>
<span class="n">ORCAcalc</span> <span class="o">=</span> <span class="n">ORCATheory</span><span class="p">(</span><span class="n">orcasimpleinput</span><span class="o">=</span><span class="s1">&#39;BP86 def2-SVP def2/J&#39;</span><span class="p">,</span> <span class="n">orcablocks</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">numcores</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">thermochem_dict</span> <span class="o">=</span> <span class="n">AnFreq</span><span class="p">(</span><span class="n">theory</span><span class="o">=</span><span class="n">ORCAcalc</span><span class="p">,</span> <span class="n">fragment</span><span class="o">=</span><span class="n">HF_frag</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Thermochem properties dict:&quot;</span><span class="p">,</span> <span class="n">thermochem_dict</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Vibrational frequencies (cm**-1) : &quot;</span><span class="p">,</span> <span class="n">thermochem_dict</span><span class="p">[</span><span class="s1">&#39;frequencies&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ZPVE (Eh) : &quot;</span><span class="p">,</span> <span class="n">thermochem_dict</span><span class="p">[</span><span class="s1">&#39;ZPVE&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Gibbs energy corrections (Eh) : &quot;</span><span class="p">,</span> <span class="n">thermochem_dict</span><span class="p">[</span><span class="s1">&#39;Gcorr&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>A dictionary containing various properties is returned (dictionary keys) from an AnFreq job:
(frequencies, ZPVE, E_trans, E_rot, E_vib, E_tot, TS_trans, TS_rot, TS_vib, TS_el, vibenergycorr, Hcorr, Gcorr, TS_tot)</p>
</div>
<div class="section" id="thermochemistry-corrections">
<h2>thermochemistry corrections<a class="headerlink" href="#thermochemistry-corrections" title="Permalink to this headline">¶</a></h2>
<p>Thermochemistry corrections are automatically calculated when either a Numfreq or Anfreq job is requested.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">thermochem_an</span> <span class="o">=</span> <span class="n">AnFreq</span><span class="p">(</span><span class="n">theory</span><span class="o">=</span><span class="n">ORCAcalc</span><span class="p">,</span> <span class="n">fragment</span><span class="o">=</span><span class="n">HF_frag</span><span class="p">)</span>
<span class="n">thermochem_num</span> <span class="o">=</span> <span class="n">NumFreq</span><span class="p">(</span><span class="n">theory</span><span class="o">=</span><span class="n">ORCAcalc</span><span class="p">,</span> <span class="n">fragment</span><span class="o">=</span><span class="n">HF_frag</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Thermochem property dict:&quot;</span><span class="p">,</span> <span class="n">thermochem_an</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ZPVE (Eh) : &quot;</span><span class="p">,</span> <span class="n">thermochem_an</span><span class="p">[</span><span class="s1">&#39;ZPVE&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>A dictionary containing various properties is returned (dictionary keys):
(frequencies, ZPVE, E_trans, E_rot, E_vib, E_tot, TS_trans, TS_rot, TS_vib, TS_el, vibenergycorr, Hcorr, Gcorr, TS_tot)</p>
<p>Alternatively, the thermochemcalc function can be called directly.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">thermochemcalc</span><span class="p">(</span><span class="n">vfreq</span><span class="p">,</span><span class="n">atoms</span><span class="p">,</span><span class="n">fragment</span><span class="p">,</span> <span class="n">multiplicity</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="mf">298.18</span><span class="p">,</span><span class="n">pressure</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
</pre></div>
</div>
<p>This function calculates the thermodynamic corrections from a list of available frequencies, number of atoms, ASH fragment object and spin multiplicity.
The temperature (default: 298.15 K) and pressure (default: 1.0 atm) can be specified.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">h2o_frag</span> <span class="o">=</span> <span class="n">Fragment</span><span class="p">(</span><span class="n">xyzfile</span><span class="o">=</span><span class="s2">&quot;h2o.xyz&quot;</span><span class="p">)</span>
<span class="c1">#Manually defined frequencies for system</span>
<span class="n">frequencies</span><span class="o">=</span><span class="p">[</span><span class="mf">1600.1</span><span class="p">,</span> <span class="mf">2300.2</span><span class="p">,</span> <span class="mf">2400.3</span><span class="p">]</span>
<span class="n">thermochemcalc</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">h2o_frag</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="mf">298.18</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="module_dynamics.html" class="btn btn-neutral float-right" title="Molecular dynamics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="singlepoint.html" class="btn btn-neutral float-left" title="Singlepoint" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Ragnar Bjornsson.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>