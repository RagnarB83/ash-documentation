

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>ORCA interface &mdash; Ash 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/my_theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="xTB interface" href="xTB-interface.html" />
    <link rel="prev" title="Plotting" href="module_plotting.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="index.html" class="icon icon-home"> Ash
          

          
            
            <img src="_static/ash-simple-logo-letterbig.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">ASH</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="About.html">About ASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Basic usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic-examples.html">Basic examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="ash_program_philosophy.html">ASH Program Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="coordinate-input.html">Coordinates and fragments</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallelization.html">Parallelization in ASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="QM-interfaces.html">QM Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="MM-interfaces.html">MM Interfaces</a></li>
</ul>
<p class="caption"><span class="caption-text">Jobtypes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="job-types.html">Job Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="singlepoint.html">Singlepoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_freq.html">Frequency calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_dynamics.html">Molecular dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="neb.html">Nudged Elastic Band Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="surfacescan.html">Surface Scans</a></li>
</ul>
<p class="caption"><span class="caption-text">Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="module_QM-MM.html">QM/MM Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_benchmarking.html">Benchmarking in ASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_workflows.html">Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_highlevel_workflows.html">Highlevel workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_molcrys.html">MOLCRYS: Automatic QM/MM for Molecular Crystals</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_PES.html">PES: PhotoElectron/PhotoEmission Spectrum</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_plotting.html">Plotting</a></li>
</ul>
<p class="caption"><span class="caption-text">Interfaces</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">ORCA interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#finding-the-orca-program">Finding the ORCA program</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#parallelization">Parallelization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#useful-orca-functions">Useful ORCA functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#useful-orca-workflows">Useful ORCA workflows</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="xTB-interface.html">xTB interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="MRCC-interface.html">MRCC interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="CFour-interface.html">CFour interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dalton-interface.html">Dalton interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="PySCF-interface.html">PySCF interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Psi4-interface.html">Psi4 interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="crest-interface.html">CREST interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="geomeTRIC-interface.html">geomeTRIC interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="knarr-interface.html">KNARR interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="OpenMM-interface.html">OpenMM interface</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Explicit-solvation.html">Explicit solvation (small molecule)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metalloprotein-I.html">Metalloprotein tutorial I: Rubredoxin</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metalloprotein-II.html">Metalloprotein tutorial II: Ferredoxin</a></li>
<li class="toctree-l1"><a class="reference internal" href="QM-MM-protein.html">QM/MM on a protein</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflows-examples.html">Workflow examples in ASH</a></li>
<li class="toctree-l1"><a class="reference internal" href="Highlevel_CC_CBS_workflows.html">Tutorial: High-level CCSD(T)/CBS workflows</a></li>
</ul>
<p class="caption"><span class="caption-text">Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="coordinate-tools.html">Coordinates and fragment tools</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Ash</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>ORCA interface</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/ORCA-interface.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="orca-interface">
<h1>ORCA interface<a class="headerlink" href="#orca-interface" title="Permalink to this headline">Â¶</a></h1>
<p>ORCATheory class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ORCATheory</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orcadir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">orcasimpleinput</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">printlevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">extrabasisatoms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extrabasis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">TDDFT</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">TDDFTroots</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">FollowRoot</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">orcablocks</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">extraline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">first_iteration_input</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">brokensym</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">HSmult</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">atomstoflip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">numcores</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nprocs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">moreadfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">moreadfile_always</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">autostart</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">propertyblock</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keep_each_run_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">print_population_analysis</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;orca&quot;</span><span class="p">,</span> <span class="n">check_for_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">check_for_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">fragment_indices</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</pre></div>
</div>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Keyword</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default value</p></th>
<th class="head"><p>Details</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">orcadir</span></code></p></td>
<td><p>string</p></td>
<td><p>None</p></td>
<td><p>Path to ORCA directory.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">orcasimpleinput</span></code></p></td>
<td><p>string</p></td>
<td><p>ââ</p></td>
<td><p>Definition of the ORCA simple-input line</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">orcablocks</span></code></p></td>
<td><p>string (multiline)</p></td>
<td><p>ââ</p></td>
<td><p>Used for block-input in the ORCA inputfile.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">extraline</span></code></p></td>
<td><p>string</p></td>
<td><p>ââ</p></td>
<td><p>Additional inputfile-option for ORCA.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">printlevel</span></code></p></td>
<td><p>integer</p></td>
<td><p>2</p></td>
<td><p>How much output printed by the ORCA module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">extrabasisatoms</span></code></p></td>
<td><p>list</p></td>
<td><p>None</p></td>
<td><p>What atomindices should have a different basis set (gets added to coordinate block)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">extrabasis</span></code></p></td>
<td><p>string</p></td>
<td><p>None</p></td>
<td><p>What the basis set on extrabasisatoms should be</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TDDFT</span></code></p></td>
<td><p>Boolean</p></td>
<td><p>False</p></td>
<td><p>Whether to do TDDFT or not. If part of a Gradient job or Optimization job then the excited state gradient is calculated and used.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TDDFTroots</span></code></p></td>
<td><p>integer</p></td>
<td><p>5</p></td>
<td><p>How many TDDFT roots to calculate if TDDFT=True</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">FollowRoot</span></code></p></td>
<td><p>integer</p></td>
<td><p>1</p></td>
<td><p>What excited state root to calculate gradient for if TDDFT=True.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">brokensym</span></code></p></td>
<td><p>Boolean</p></td>
<td><p>False</p></td>
<td><p>Whether to do a Flipspin ORCA calculation to find a BS solution. Requires HSmult and atomstoflip options.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">HSmult</span></code></p></td>
<td><p>integer</p></td>
<td><p>None</p></td>
<td><p>What high-spin multiplicity to use in a brokensym=True job.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">atomstoflip</span></code></p></td>
<td><p>list</p></td>
<td><p>None</p></td>
<td><p>What atom indices to spin-flip.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">moreadfile</span></code></p></td>
<td><p>string</p></td>
<td><p>None</p></td>
<td><p>Name of file or path to file of a GBWfile to read in to the ORCA calculation</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">moreadfile_always</span></code></p></td>
<td><p>Boolean</p></td>
<td><p>False</p></td>
<td><p>Whether moreadfile option is constantly applied for all runs using this ORCATheory object or only for first run. Default: False meaning moreadfile is only used for first run using ORCATHeory object.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">autostart</span></code></p></td>
<td><p>Boolean</p></td>
<td><p>True</p></td>
<td><p>Whether ORCA will automatically try to read orbitals from a GBW file with same basename.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">numcores</span></code></p></td>
<td><p>integer</p></td>
<td><p>1</p></td>
<td><p>Number of cores to use for ORCA</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">filename</span></code></p></td>
<td><p>string</p></td>
<td><p>âorcaâ</p></td>
<td><p>Name of inputfile and outputfile</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">label</span></code></p></td>
<td><p>string</p></td>
<td><p>None</p></td>
<td><p>Label for ORCA object. Useful if working with many ORCATheory objects to distinguish them.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">propertyblock</span></code></p></td>
<td><p>string</p></td>
<td><p>None</p></td>
<td><p>String containing ORCA-block input (e.g. %eprnmr) that must come after the coordinates.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">keep_each_run_output</span></code></p></td>
<td><p>Boolean</p></td>
<td><p>False</p></td>
<td><p>Whether to keep copy of each ORCA outputfile from each run-call (e.g. each Opt-step).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">print_population_analysis</span></code></p></td>
<td><p>Boolean</p></td>
<td><p>False</p></td>
<td><p>Whether to print Mulliken population analysis for each step</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">print_population_analysis</span></code></p></td>
<td><p>Boolean</p></td>
<td><p>False</p></td>
<td><p>Whether to print Mulliken population analysis for each step</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">check_for_errors</span></code></p></td>
<td><p>Boolean</p></td>
<td><p>True</p></td>
<td><p>Whether to check for errors in ORCA output once ORCA calculation is done.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">check_for_warnings</span></code></p></td>
<td><p>Boolean</p></td>
<td><p>True</p></td>
<td><p>Whether to check for warnings in ORCA output once ORCA calculation is done.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">fragment_indices</span></code></p></td>
<td><p>list of lists</p></td>
<td><p>None</p></td>
<td><p>Optional: list of lists of atom indices that specify whether atoms belong to a specific ORCA fragment (e.g. for ORCA multi-level PNO calculations). Example: [[1,2,3],[10,11,12],[13,14,15]]. Will affect the coordinate-block in the ORCA inputfile. For QM/MM: atom indices must be in QM-region.</p></td>
</tr>
</tbody>
</table>
<div class="section" id="finding-the-orca-program">
<h2>Finding the ORCA program<a class="headerlink" href="#finding-the-orca-program" title="Permalink to this headline">Â¶</a></h2>
<p>ASH can find the ORCA program in a few different ways.</p>
<ul class="simple">
<li><p>ASH will first check if the orcadir argument has been set which should be a string that points to the directory where the orca program is located, e.g. âorcadir=/path/to/orca_5_0_2â. This option takes precedence.</p></li>
<li><p>If the orcadir argument has not been provided ASH will next see if orcadir has been provided in the ASH settings (~/ash_user_settings.ini file): See <a class="reference internal" href="basics.html"><span class="doc">Basic usage</span></a></p></li>
<li><p>If orcadir has also not been defined at all, ASH will next search the operating systemsâs PATH environment variable for an executable âorcaâ and if found, will set the orcadir accordingly and use that ORCA version.  This can be a convenient option if you make sure to define your shell environments carefully in your jobscript or shell-startup file. Be careful, however, if you have multiple versions of the program available.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The ORCA program binaries are nowadays often provided as a small-size shared version (has dynamically linked binaries). This means that for ORCA to run using the shared-library version, both the PATH and LD_LIBRARY_PATH needs to be set in the shell environment (should point to the ORCA directory).
ASH can not set the LD_LIBRARY_PATH (must be done in the shell environment beforehand) and thus if LD_LIBRARY_PATH has not been set properly in the shell, ORCA will crash when called by ASH.
This means that it is usually best to set the PATH and LD_LIBRARY_PATH to ORCA in your jobscript or login shell-file (.bashrc, .bash_profile etc.) and ASH will then be able to find ORCA like that.</p>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">Â¶</a></h2>
<p>The ORCA interface is quite flexible. orcasimpleinput and orcablocks keyword arguments (accepts single or multi-line strings) have to be provided and these keywords define what the ORCA-inputfile looks like.
This means that you can completely control what type of electronic structure method should be used by ORCA including choosing aspects such as basis set, convergence and grid settings etc.
The geometry block will be added to the inputfile by ASH.
Note that ASH handles aspects such as telling ORCA what orbitals to read as well as parallelization.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not put parallelization information (! Pal4 or %pal nprocs 4 end)or job-type keywords such as â! Optâ â!Freqâ to the orcasimpleinput and orcablocks variables.
Such functionality is handled by ASH separately.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Create fragment object from XYZ-file</span>
<span class="n">HF_frag</span><span class="o">=</span><span class="n">Fragment</span><span class="p">(</span><span class="n">xyzfile</span><span class="o">=</span><span class="s1">&#39;hf.xyz&#39;</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mult</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#ORCA</span>
<span class="nb">input</span><span class="o">=</span><span class="s2">&quot;! BP86 def2-SVP tightscf&quot;</span>
<span class="n">blocks</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="si">%s</span><span class="s2">cf</span>
<span class="s2">maxiter 200</span>
<span class="s2">end</span>
<span class="s2">%basis</span>
<span class="s2">newgto F &quot;ma-def2-SVP&quot; end</span>
<span class="s2">end</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">ORCAcalc</span> <span class="o">=</span> <span class="n">ORCATheory</span><span class="p">(</span><span class="n">orcasimpleinput</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">orcablocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span> <span class="n">numcores</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="c1">#Run a single-point energy job</span>
<span class="n">Singlepoint</span><span class="p">(</span><span class="n">theory</span><span class="o">=</span><span class="n">ORCAcalc</span><span class="p">,</span> <span class="n">fragment</span><span class="o">=</span><span class="n">HF_frag</span><span class="p">)</span>
<span class="c1">#An Energy+Gradient calculation</span>
<span class="n">Singlepoint</span><span class="p">(</span><span class="n">theory</span><span class="o">=</span><span class="n">ORCAcalc</span><span class="p">,</span> <span class="n">fragment</span><span class="o">=</span><span class="n">HF_frag</span><span class="p">,</span> <span class="n">Grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Here a fragment (here called HF_frag with a defined charge and multiplicity) is defined (from an XYZ file) and passed to the Singlepoint function along with an ORCAtheory object (called ORCAcalc). The input, and blocks string variables are defined and passed onto the ORCA object via keyword arguments.
By default, the ORCA autostart feature is active, meaning that if an inputfile with name âorca-input.inpâ is run, ORCA will
try to read orbitals from âorca-input.gbwâ file if present. This is utilized automatically during geometry optimizations, numerical frequencies as well
as multiple single-point calculations sequentially. It is possible to turn this off by adding â!Noautostartâ in the simple-inputline of the orcasimpleinput variable or by setting autostart=False when defining ORCATheory object.
It is also possible to have each ORCA-calculation read in orbitals from another source by using the: moreadfile keyword argument option:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ORCAcalc</span> <span class="o">=</span> <span class="n">ORCATheory</span><span class="p">(</span><span class="n">orcadir</span><span class="o">=</span><span class="n">orcadir</span><span class="p">,</span> <span class="n">orcasimpleinput</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span>
                    <span class="n">orcablocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span> <span class="n">numcores</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">moreadfile</span><span class="o">=</span><span class="s2">&quot;orbitals.gbw&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note: For parallel-ASH calculations (ASH in parallel, ORCA in serial). The full path to the moreadfile may be required.</p>
<p>The ORCA object is then used by passing it to a function: e.g. Singlepoint, an optimizer, a QM/MM object, NumFreq function etc.
When the ORCA object is run (e.g. by the Singlepoint function, an optimizer etc.) it will create an ORCA inputfile
that will always be called orca-input.inp. This inputfile will look familiar to any ORCA user as it will contain a âSimpleinput lineâ, Block-input
a coordinate block etc. (cordinates in Ã). ASH will then tell ORCA to run the inputfile and an outputfile called orca-input.out will be created.
Once the ORCA calculation is done the outputfile (or other files) is read for information (usually the energy and gradient) by ASH
and ASH will continue. The ORCA inputfile , âorca-input.inpâ may be replaced later (e.g. if an optimization jobâ and ORCA
will be run again.</p>
</div>
<div class="section" id="parallelization">
<h2>Parallelization<a class="headerlink" href="#parallelization" title="Permalink to this headline">Â¶</a></h2>
<p>ORCA parallelization is handled by OpenMPI. By specifying the numcores=X, a <em>%pal numcores X end block</em> will be added to the
ORCA inputfile created by Ash. ORCA will then call the OpenMPI mpirun binary when needed and this requires the
correct OpenMPI version to be available.
Make sure the recommended OpenMPI version for the ORCA version you are using is available. This typically requires
setting (in the shell or jobscript):</p>
<p>export PATH=/path/to/openmpi/bin:$PATH and export LD_LIBRARY_PATH=/path/to/openmpi/lib:$LD_LIBRARY_PATH</p>
<p>or alternatively loading the appropriate module. Set these variables in the job-script (see <a class="reference internal" href="basics.html"><span class="doc">Basic usage</span></a>) that you are using.</p>
</div>
<div class="section" id="useful-orca-functions">
<h2>Useful ORCA functions<a class="headerlink" href="#useful-orca-functions" title="Permalink to this headline">Â¶</a></h2>
<p>In addition to the ORCATheory class, there are a number of built-in functions inside that can help grab specific information from an ORCA outputfile etc.
To use these functions, the module has to be loaded first: import interfaces.interface_ORCA.py</p>
<p><strong>run__orca_plot</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run_orca_plot</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">orcadir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gridvalue</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span><span class="n">densityfilename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mo_operator</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mo_number</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</pre></div>
</div>
<p>To be documented:</p>
<p>grab_EFG_from_ORCA_output(filename)</p>
<p>ICE_WF_size(filename)</p>
<p>QRO_occ_energies_grab(filename)</p>
<p>CASSCF_natocc_grab(filename)</p>
<p>SCF_FODocc_grab(filename)</p>
<p>MP2_natocc_grab(filename)</p>
<p>check_stability_in_output(file)</p>
<p>grabEOMIPs(file)</p>
<p>grabatomcharges_ORCA(chargemodel,outputfile)</p>
<p>chargemodel_select(chargemodel)</p>
<p>read_ORCA_Hessian(hessfile)</p>
<p>ORCAfrequenciesgrab(hessfile)</p>
<p>write_ORCA_Hessfile(hessian, coords, elems, masses, hessatoms,outputname)</p>
<p>grab_spin_expect_values_ORCA(file)</p>
<p>MolecularOrbitalGrab(file)</p>
<p>grabtrajenergies(filename)</p>
<p>tddftgrab(file)</p>
<p>xesgrab(file)</p>
<p>grab_HF_and_corr_energies(file, DLPNO=False, F12=False)</p>
<p>scfenergygrab(file)</p>
<p>finalenergiesgrab(file)</p>
<p>checkORCAfinished(file)</p>
<p>grab_coordinates_from_ORCA_output(outfile)</p>
</div>
<div class="section" id="useful-orca-workflows">
<h2>Useful ORCA workflows<a class="headerlink" href="#useful-orca-workflows" title="Permalink to this headline">Â¶</a></h2>
<p>Examples of useful ways to automate various ORCA calculations.</p>
<p><strong>Plot ORCA-calculated spectra (using orca_mapspc) and normalize</strong></p>
<p>Uses ASH functions: <strong>grab_coordinates_from_ORCA_output</strong>, <strong>run_orca_mapspc</strong>, <strong>read_datafile</strong>, <strong>write_datafile</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ash</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">glob</span>

<span class="c1">#Simple ASH script to plot XES spectra from multiple ORCA XES-job outputfiles and normalize w.r.t. to number of absorber elements</span>
<span class="n">absorber_element</span><span class="o">=</span><span class="s2">&quot;Fe&quot;</span>

<span class="c1">#orca_mapspc settings</span>
<span class="n">orca_mapspc_option</span><span class="o">=</span><span class="s1">&#39;XESQ&#39;</span>
<span class="n">broadening</span><span class="o">=</span><span class="mf">1.0</span>
<span class="n">numpoints</span><span class="o">=</span><span class="mi">5000</span>
<span class="n">start_value</span><span class="o">=</span><span class="mi">0</span>
<span class="n">end_value</span><span class="o">=</span><span class="mi">8000</span>
<span class="n">unit</span><span class="o">=</span><span class="s1">&#39;eV&#39;</span>

<span class="c1">#Loop over ORCA outputfiles and run orca_mapspc</span>
<span class="k">for</span> <span class="n">outfile</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.out&quot;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Outfile:&quot;</span><span class="p">,</span> <span class="n">outfile</span><span class="p">)</span>
    <span class="c1">#Get number of absorber elements in molecule from outputfile</span>
    <span class="n">elems</span><span class="p">,</span><span class="n">coords</span> <span class="o">=</span> <span class="n">grab_coordinates_from_ORCA_output</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
    <span class="n">elementcount</span> <span class="o">=</span> <span class="n">elems</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">absorber_element</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of </span><span class="si">{</span><span class="n">absorber_element</span><span class="si">}</span><span class="s2"> atoms in file:&quot;</span><span class="p">,</span> <span class="n">elementcount</span><span class="p">)</span>
    <span class="c1">#Get XES .at and .stk files via orca_mapspc</span>
    <span class="n">run_orca_mapspc</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">orca_mapspc_option</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start_value</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end_value</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">broadening</span><span class="o">=</span><span class="n">broadening</span><span class="p">,</span> <span class="n">points</span><span class="o">=</span><span class="n">numpoints</span><span class="p">)</span>
    <span class="c1">#Read .dat file. Get x and y values as numpy arrays</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">read_datafile</span><span class="p">(</span><span class="n">outfile</span><span class="o">+</span><span class="s2">&quot;.xesq.dat&quot;</span><span class="p">)</span>
    <span class="c1">#Scale y-values</span>
    <span class="n">scalingfactor</span><span class="o">=</span><span class="n">elementcount</span>
    <span class="n">write_datafile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">/</span><span class="n">scalingfactor</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">outfile</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;_SCALED_by_</span><span class="si">{</span><span class="n">scalingfactor</span><span class="si">}</span><span class="s2">.xesq.dat&quot;</span><span class="p">)</span>
    <span class="c1">#Read .stk file</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">read_datafile</span><span class="p">(</span><span class="n">outfile</span><span class="o">+</span><span class="s2">&quot;.xesq.stk&quot;</span><span class="p">)</span>
    <span class="c1">#Scale y-values</span>
    <span class="n">write_datafile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">/</span><span class="n">scalingfactor</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">outfile</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot;_SCALED_by_</span><span class="si">{</span><span class="n">scalingfactor</span><span class="si">}</span><span class="s2">.xesq.stk&quot;</span><span class="p">)</span>
<span class="c1">#</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="xTB-interface.html" class="btn btn-neutral float-right" title="xTB interface" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="module_plotting.html" class="btn btn-neutral float-left" title="Plotting" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Ragnar Bjornsson.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>